рЃЊрЃљрЃЋрЃўрЃгрЃДрЃЮрЃЌ рЃЏрЃБрЃерЃљрЃЮрЃЉрЃљ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃ»рЃћрЃа рЃарЃЮрЃњрЃЮрЃарЃф рЃДрЃЮрЃЋрЃћрЃџрЃЌрЃЋрЃўрЃА рЃЋрЃћрЃфрЃЊрЃћрЃЉрЃў рЃњрЃљрЃЋрЃћрЃарЃЎрЃЋрЃўрЃЮ рЃЊрЃљрЃбрЃљрЃерЃў.

рЃЎрЃЮрЃџрЃљрЃЉрЃерЃў рЃЋрЃўрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉ рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃюрЃљрЃ«рЃћрЃЌ рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃўрЃљ рЃЎрЃћрЃњрЃџрЃерЃў рЃЏрЃБрЃерЃљрЃЮрЃЉрЃљрЃќрЃћ.

рЃЏрЃўрЃюрЃЊрЃљ рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃЮ рЃарЃЮрЃЏ рЃАрЃљрЃюрЃљрЃЏ рЃЊрЃљрЃЋрЃўрЃгрЃДрЃћрЃЉрЃЊрЃў рЃЏрЃљрЃюрЃљрЃЏрЃЊрЃћ рЃарЃљрЃдрЃљрЃф рЃЋрЃўрЃЊрЃћрЃЮрЃћрЃЉрЃў рЃЋрЃюрЃљрЃ«рЃћ time series рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃћрЃЉрЃќрЃћ рЃЊрЃљ рЃарЃљрЃдрЃљрЃф рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃћрЃЉрЃў рЃњрЃљрЃЋрЃўрЃљрЃќрЃарЃћ.

рЃ»рЃћрЃа рЃњрЃљрЃюрЃЋрЃўрЃ«рЃўрЃџрЃЮрЃЌ рЃарЃљрЃф рЃгрЃћрЃарЃўрЃљ:
рЃгрЃћрЃарЃўрЃљ рЃарЃЮрЃЏ рЃДрЃБрЃарЃљрЃЊрЃдрЃћрЃЉрЃљ рЃћрЃЦрЃфрЃћрЃЋрЃљ holidays weeks рЃЊрЃљ 5рЃ»рЃћрЃа рЃЏрЃћрЃбрЃљрЃЊ рЃўрЃЌрЃЋрЃџрЃћрЃЉрЃљрЃЮ. рЃљрЃџрЃЉрЃљрЃЌ рЃљрЃЏрЃўрЃбрЃЮ рЃњрЃЋрЃљрЃЦ WMAE.

рЃњрЃЋрЃљрЃЦ stores.csv рЃАрЃљрЃЊрЃљрЃф рЃљрЃарЃўрЃА 45 store-рЃќрЃћ рЃўрЃюрЃцрЃЮрЃарЃЏрЃљрЃфрЃўрЃћрЃЉрЃў
 id, Type(A, B, C) , size 

рЃњрЃЋрЃљрЃЦ train.csv  2010-02-05 to 2012-11-01
Store, Department, Date, Weekly_Sales, IsHoliday

рЃЎрЃўрЃЊрЃћрЃЋ test.csv
Store, Department, Date, Weekly_Sales, IsHoliday

рЃЊрЃљ рЃћрЃА рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃБрЃџрЃў рЃарЃљрЃЏрЃћрЃљ: features.csv
CPI, unemployment, fuel price, temperature, MarkDown1-5, sparse data.

рЃћрЃАрЃћрЃюрЃў рЃЎрЃўрЃЊрЃћ рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў 5x рЃЊрЃдрЃћрЃћрЃЉрЃў:

Super Bowl: 12-Feb-10, 11-Feb-11, 10-Feb-12, 8-Feb-13
Labor Day: 10-Sep-10, 9-Sep-11, 7-Sep-12, 6-Sep-13
Thanksgiving: 26-Nov-10, 25-Nov-11, 23-Nov-12, 29-Nov-13
Christmas: 31-Dec-10, 30-Dec-11, 28-Dec-12, 27-Dec-13



рЃЎрЃљрЃў рЃљрЃ«рЃџрЃљ рЃБрЃЎрЃЋрЃћ рЃЊрЃљрЃЋрЃўрЃгрЃДрЃЮрЃЌ:

# experiment_1_k.ipynb
рЃљрЃЦ рЃ»рЃћрЃа рЃЊрЃљрЃЋрЃљрЃБрЃюрЃќрЃўрЃърЃћрЃЉ colab-рЃерЃў рЃцрЃљрЃўрЃџрЃћрЃЉрЃА рЃЊрЃљ рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃарЃљ рЃарЃЮрЃњрЃЮрЃа рЃњрЃљрЃЏрЃЮрЃўрЃДрЃБрЃарЃћрЃЉрЃљ:

­ЪЊі DATASET OVERVIEW
==================================================
STORES:
  Shape: (45, 3)
  Columns: ['Store', 'Type', 'Size']
  Memory: 0.00 MB

TRAIN:
  Shape: (421570, 5)
  Columns: ['Store', 'Dept', 'Date', 'Weekly_Sales', 'IsHoliday']
  Memory: 36.99 MB

TEST:
  Shape: (115064, 4)
  Columns: ['Store', 'Dept', 'Date', 'IsHoliday']
  Memory: 9.22 MB

FEATURES:
  Shape: (8190, 12)
  Columns: ['Store', 'Date', 'Temperature', 'Fuel_Price', 'MarkDown1', 'MarkDown2', 'MarkDown3', 'MarkDown4', 'MarkDown5', 'CPI', 'Unemployment', 'IsHoliday']
  Memory: 1.16 MB


рЃюрЃБ рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃў рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋрЃў рЃЏрЃљрЃњрЃарЃљрЃЏ features рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃў рЃфрЃЮрЃбрЃљ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃўрЃљ рЃ»рЃћрЃа рЃљрЃа рЃЋрЃўрЃфрЃў рЃарЃЮрЃњрЃЮрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃЮ рЃЏрЃљрЃарЃљ рЃЋрЃюрЃљрЃ«рЃЮрЃЌ.

рЃњрЃљрЃюрЃЋрЃўрЃ«рЃўрЃџрЃЮрЃЌ рЃфрЃљрЃџ рЃфрЃљрЃџрЃЎрЃћ рЃДрЃЋрЃћрЃџрЃљ рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃў:

­ЪЈф STORES DATASET
==============================
Number of stores: 45
Store types: {'A': 22, 'B': 17, 'C': 6}
Size range: 34,875 - 219,622

рЃ«рЃЮ рЃюрЃБ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ рЃфрЃЮрЃЊрЃљ C рЃбрЃўрЃърЃўрЃА рЃњрЃЋрЃљрЃЦ.

рЃАрЃЌрЃЮрЃарЃћрЃЉрЃерЃў рЃћрЃА рЃбрЃўрЃърЃћрЃЉрЃў рЃАрЃўрЃЊрЃћрЃўрЃЊрЃћрЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌрЃљрЃљ рЃљрЃюрЃБ рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЊрЃўрЃЊрЃўрЃљ A рЃЏрЃћрЃарЃћ B рЃЊрЃљ рЃЉрЃЮрЃџрЃЮрЃА C. 

­ЪЊѕ TRAINING DATASET
==============================
Date range: 2010-02-05 00:00:00 to 2012-10-26 00:00:00
Stores: 45
Departments: 81
Total records: 421,570
Holiday weeks: 29,661
Sales range: $-4,988.94 to $693,099.36

421,570 - рЃюрЃљрЃЏрЃЊрЃЋрЃўрЃџрЃљрЃЊ рЃЊрЃўрЃЊрЃў рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃўрЃљ.


­Ъњ░ SALES ANALYSIS
=========================
Mean weekly sales: $15,981.26
Median weekly sales: $7,612.03

Holiday vs Non-Holiday Sales:
mean	median	count
IsHoliday			
False	15901.445069	7589.95	391909
True	17035.823187	7947.74	29661




Top 10 departments by average sales:
Weekly_Sales
Dept	
92	75204.870531
95	69824.423080
38	61090.619568
72	50566.515417
65	45441.706224
90	45232.084488
40	44900.702727
2	43607.020113
91	33687.910758
94	33405.883963


рЃарЃЮрЃњрЃЮрЃарЃф рЃЕрЃљрЃюрЃА holiday-рЃА рЃЊрЃарЃЮрЃА 7% рЃўрЃЌ рЃЏрЃћрЃбрЃў sale рЃњрЃЋрЃљрЃЦ.


­ЪїА№ИЈ FEATURES DATASET
==============================
Date range: 2010-02-05 00:00:00 to 2013-07-26 00:00:00
Stores covered: 45
Store	Date	Temperature	Fuel_Price	MarkDown1	MarkDown2	MarkDown3	MarkDown4	MarkDown5	CPI	Unemployment	IsHoliday
0	1	2010-02-05	42.31	2.572	NaN	NaN	NaN	NaN	NaN	211.096358	8.106	False
1	1	2010-02-12	38.51	2.548	NaN	NaN	NaN	NaN	NaN	211.242170	8.106	True
2	1	2010-02-19	39.93	2.514	NaN	NaN	NaN	NaN	NaN	211.289143	8.106	False
3	1	2010-02-26	46.63	2.561	NaN	NaN	NaN	NaN	NaN	211.319643	8.106	False
4	1	2010-03-05	46.50	2.625	NaN	NaN	NaN	NaN	NaN	211.350143	8.106	False



Missing values:
Missing Count	Missing %
MarkDown1	4158	50.769231
MarkDown2	5269	64.334554
MarkDown3	4577	55.885226
MarkDown4	4726	57.704518
MarkDown5	4140	50.549451
CPI	585	7.142857
Unemployment	585	7.142857

рЃљрЃЦ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў store-рЃАрЃЌрЃЋрЃўрЃА рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃњрЃљрЃЏрЃЮрЃДрЃЋрЃљрЃюрЃўрЃџрЃў Feature-рЃЉрЃў рЃњрЃЋрЃљрЃЦ рЃЏрЃљрЃарЃљ рЃљрЃАрЃћрЃЋрЃћ рЃњрЃЋрЃљрЃЦрЃЋрЃА рЃЉрЃћрЃЋрЃарЃў NAN.

рЃ«рЃЮ markdown-рЃерЃў рЃћрЃгрЃћрЃарЃљ рЃарЃЮрЃЏ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ 2011 -рЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃњрЃЋрЃљрЃЦрЃЮ рЃЊрЃљ рЃљрЃАрЃћрЃЋрЃћ рЃДрЃЋрЃћрЃџрЃљрЃерЃў рЃљрЃарЃљрЃЮ:

­Ъћќ MARKDOWN DATA AVAILABILITY
===================================
MarkDown1: 4,032 records (49.2%)
MarkDown2: 2,921 records (35.7%)
MarkDown3: 3,613 records (44.1%)
MarkDown4: 3,464 records (42.3%)
MarkDown5: 4,050 records (49.5%)

First markdown data: 2011-11-11 00:00:00
As stated: Should be after Nov 2011 РюЊ

рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃћ рЃцрЃџрЃЮрЃЌрЃћрЃЉрЃў рЃЊрЃљ рЃарЃљрЃАрЃљрЃф рЃЋрЃ«рЃћрЃЊрЃљрЃЋ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃўрЃА рЃърЃљрЃбрЃћрЃарЃюрЃўрЃф рЃўрЃњрЃарЃФрЃюрЃЮрЃЉрЃљ - рЃўрЃљрЃюрЃЋрЃљрЃарЃерЃў рЃърЃўрЃЎрЃерЃўрЃљ рЃЮрЃарЃўрЃЋрЃћ рЃгрЃћрЃџрЃА рЃњрЃљрЃДрЃўрЃЊрЃЋрЃћрЃЉрЃў.

### рЃЎрЃљрЃў рЃЊрЃљрЃЋрЃўрЃгрЃДрЃЮрЃЌ рЃЊрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉрЃљ рЃарЃљрЃф рЃљрЃарЃўрЃА рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњ рЃАрЃћрЃбрЃў рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃўрЃЏрЃљрЃќрЃћ рЃ»рЃћрЃа рЃљрЃа рЃњрЃЋрЃўрЃюрЃЊрЃљ рЃАрЃ«рЃЋрЃљ рЃљрЃарЃљрЃцрЃћрЃарЃў. 
рЃ»рЃћрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ xgboost-рЃА.
рЃЌрЃљрЃЋрЃўрЃАрЃЌрЃљрЃЋрЃљрЃЊ рЃЊрЃљрЃЋрЃџрЃЮрЃњрЃљрЃЋ mlflow-рЃќрЃћ. 
рЃ»рЃћрЃа рЃЏрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃћрЃЉрЃА рЃБрЃЉрЃарЃљрЃџрЃЮрЃЊ рЃБрЃЏрЃљрЃарЃбрЃўрЃЋрЃћрЃАрЃў рЃарЃљ рЃАрЃЦрЃЮрЃарЃА рЃњрЃЋрЃљрЃФрЃџрЃћрЃЋрЃА.

рЃ»рЃћрЃа рЃўрЃюрЃўрЃфрЃўрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ dagshub, рЃЊрЃљ mlflow-рЃќрЃћ. 

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/

рЃ»рЃћрЃб рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ train.csv-рЃА рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ.
https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/0?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃ«рЃЮ рЃюрЃБ BasicPreprocessor рЃћрЃА рЃБрЃЏрЃљрЃарЃбрЃўрЃЋрЃћрЃАрЃў рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃЮрЃарЃў.

рЃ«рЃЮрЃџрЃЮ рЃарЃљрЃф рЃерЃћрЃћрЃ«рЃћрЃЉрЃљ рЃЊрЃљрЃбрЃљрЃА:
trains рЃњрЃљрЃЋрЃДрЃЮрЃц 3-рЃљрЃЊ train + val +test . 60, 20 , 20
рЃюрЃБ store-рЃћрЃЉрЃўрЃА рЃўрЃюрЃцрЃЮ рЃњрЃЋрЃўрЃюрЃЊрЃљ рЃЌрЃљрЃЋрЃўрЃАрЃЌрЃљрЃЋрЃљрЃЊ рЃБрЃћрЃГрЃЋрЃћрЃџрЃў рЃљрЃЏрЃўрЃбрЃЮ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃљрЃЏрЃљрЃА рЃЊрЃљрЃЋрЃЏрЃћрЃарЃ»рЃљрЃЋ. рЃЊрЃљ рЃљрЃАрЃћрЃЋрЃћ type_encoder-рЃА рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ рЃарЃЮрЃЏ рЃарЃўрЃфрЃЋрЃЋрЃћрЃЉрЃўрЃЌ рЃњрЃЋрЃЦрЃЮрЃюрЃЊрЃћрЃА рЃћрЃАрЃћрЃюрЃў 0,1,2

рЃљрЃАрЃћрЃЋрЃћ holiday рЃЌрЃБ рЃљрЃарЃўрЃА 1 рЃЌрЃБ рЃљрЃарЃљ 0.

рЃЎрЃўрЃЊрЃћрЃЋ рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃўрЃЊрЃћрЃЮрЃерЃў рЃЋрЃюрЃљрЃ«рЃћ рЃљрЃЦрЃљрЃф рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃЋрЃљрЃю date-рЃўрЃЊрЃљрЃю рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃА : Year,Month , Week, DayOfYear

рЃЏрЃўрЃАрЃўрЃюрЃњ рЃЋрЃљрЃџрЃўрЃБрЃћрЃЉрЃерЃў рЃ»рЃћрЃа рЃърЃарЃЮрЃАрЃбрЃљ median (numerical) рЃЊрЃљ mode (categorical) рЃЕрЃљрЃЋрЃљрЃюрЃљрЃфрЃЋрЃџрЃћрЃЉ.

рЃарЃљрЃф рЃерЃћрЃћрЃ«рЃћрЃЉрЃљ рЃбрЃарЃљрЃўрЃюрЃўрЃюрЃњ xgboost: 100 рЃ«рЃћ, 6 рЃЏрЃљрЃЦрЃАрЃўрЃЏрЃљрЃџрЃБрЃарЃў рЃАрЃўрЃдрЃарЃЏрЃћ, 0.1 rate. 

рЃюрЃБ рЃерЃћрЃАрЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉрЃџрЃљрЃЊ WMAE.
рЃљрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃћ рЃЏрЃљрЃњрЃўрЃАрЃў рЃЎрЃџрЃљрЃАрЃў.
https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/0/runs/0f1276d7c85f426cb849c646a6d72ab5

­ЪЊі FINAL WMAE RESULTS:
   Competition Metric (WMAE): $4,110.79
   Regular MAE: $3,966.39
   Holiday weeks MAE: $4,619.24
   Normal weeks MAE: $3,916.50


рЃюрЃБ рЃћрЃА рЃљрЃарЃўрЃА score , рЃџрЃўрЃЊрЃћрЃарЃЉрЃЮрЃарЃЊрЃћрЃЉрЃерЃў рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃерЃћрЃЊрЃћрЃњрЃў 2300 -рЃўрЃљ. 

рЃЕрЃЋрЃћрЃю рЃЎрЃўрЃЊрЃћ 4,110. 

рЃЎрЃљрЃў рЃюрЃБ рЃ»рЃћрЃа рЃћрЃА рЃўрЃДрЃЮрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃърЃўрЃарЃЋрЃћрЃџрЃў рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃўрЃАрЃЌрЃЋрЃўрЃА.

рЃЊрЃљрЃЋрЃцрЃБрЃерЃћ github-рЃќрЃћ рЃЏрЃљрЃарЃљ рЃарЃљрЃдрЃљрЃф рЃЋрЃўрЃ»рЃћрЃбрЃћрЃЉрЃў рЃљрЃа рЃЏрЃЮрЃАрЃгрЃЮрЃюрЃА рЃЊрЃљ рЃљрЃа рЃљрЃюрЃљрЃ«рЃћрЃЉрЃА рЃљрЃЏрЃўрЃбрЃЮ рЃЌрЃБ рЃюрЃЮрЃЌрЃЉрЃБрЃЦрЃерЃў рЃЕрЃљрЃ«рЃћрЃЊрЃЋрЃљ рЃњрЃўрЃюрЃЊрЃљрЃЌ рЃЊрЃљрЃцрЃБрЃџрЃЋрЃљ рЃЏрЃЮрЃњрЃўрЃгрЃћрЃЋрЃЌ.
рЃљрЃЊрЃарЃћ рЃЋрЃюрЃљрЃ«рЃћ рЃЏрЃАрЃњрЃљрЃЋрЃАрЃў рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃљрЃЦ рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџрЃў рЃЦрЃАрЃћрЃџрЃўрЃАрЃюрЃљрЃўрЃарЃљрЃЊ рЃћрЃърЃЮрЃЦрЃћрЃЉрЃўрЃА рЃљрЃЋрЃАрЃћрЃЉрЃљ рЃљрЃа рЃљрЃарЃўрЃА рЃЊрЃљ рЃљрЃарЃф рЃљрЃгрЃўрЃЌрЃџрЃћрЃЉрЃА рЃџрЃЮрЃЎрЃљрЃџрЃБрЃарЃљрЃЊ рЃЊрЃљ рЃЋрЃћрЃа рЃЋрЃ«рЃЋрЃЊрЃћрЃЉрЃў рЃћрЃ«рЃљ рЃарЃљрЃбрЃЮ рЃљрЃЦ рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ.

# experiment_2_future_engineering_k.ipynb

рЃЎрЃљрЃў, рЃарЃљрЃЊрЃњрЃљрЃю рЃЋрЃюрЃљрЃ«рЃћ рЃќрЃЮрЃњрЃљрЃЊрЃљрЃЊ рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋрЃў рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃбрЃарЃљрЃўрЃюрЃўрЃюрЃњрЃўрЃЌ рЃАрЃЦрЃЮрЃарЃў, рЃљрЃ«рЃџрЃљ рЃЊрЃљрЃЋрЃўрЃгрЃДрЃЮрЃЌ рЃюрЃћрЃџ рЃюрЃћрЃџрЃљ рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃў рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃерЃћрЃЋрЃЦрЃћрЃюрЃў рЃљрЃ«рЃљрЃџрЃў рЃцрЃљрЃўрЃџрЃў рЃАрЃљрЃЊрЃљрЃф рЃЊрЃљрЃЋрЃљрЃЎрЃЋрЃўрЃарЃЊрЃћрЃЉрЃў рЃЊрЃљрЃЌрЃљрЃА рЃЊрЃљ рЃЋрЃфрЃЊрЃў рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃћрЃЉрЃА рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃўрЃАрЃЌрЃўрЃА.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/1

рЃљрЃЦрЃљрЃф рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋрЃљрЃЊ рЃўрЃюрЃўрЃфрЃўрЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ рЃњрЃљрЃЋрЃБрЃЎрЃћрЃЌрЃћ mlflow-рЃќрЃћ
 рЃ»рЃћрЃа рЃЊрЃљрЃЋрЃЏрЃћрЃарЃ»рЃћ рЃДрЃЋрЃћрЃџрЃљ рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃў рЃћрЃарЃЌрЃЏрЃљрЃюрЃћрЃЌрЃЌрЃљрЃю.
рЃюрЃБ рЃЊрЃБрЃърЃџрЃўрЃЎрЃљрЃбрЃў рЃАрЃЋрЃћрЃбрЃў рЃљрЃдрЃЏрЃЮрЃњрЃЋрЃўрЃЕрЃюрЃЊрЃљ isholiday -рЃ»рЃћрЃа рЃћрЃњ рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃћ. 

рЃ»рЃћрЃа рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћ рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў:
year, month, day, dayOfweek,weekofyear,quarter, IsWeekend,IsMonthStart,IsMonthEnd,IsQuarterStart,IsQuarterEnd

рЃерЃћрЃЏрЃЊрЃћрЃњ:

DaysFromStart, WeeksFromStart -рЃћрЃАрЃћрЃюрЃў рЃарЃЮрЃњрЃЮрЃарЃф рЃњрЃљрЃЋрЃљрЃарЃЎрЃЋрЃўрЃћ рЃЎрЃљрЃўрЃљрЃЮ linear trend-рЃўрЃА рЃЊрЃљрЃАрЃљрЃГрЃћрЃарЃљрЃЊрЃЮ.

['Store', 'Dept', 'Date', 'Weekly_Sales', 'Type', 'Size', 'Temperature', 'Fuel_Price', 'MarkDown1', 'MarkDown2', 'MarkDown3', 'MarkDown4', 'MarkDown5', 'CPI', 'Unemployment', 'IsHoliday', 'Year', 'Month', 'Day', 'DayOfWeek', 'WeekOfYear', 'Quarter', 'IsWeekend', 'IsMonthStart', 'IsMonthEnd', 'IsQuarterStart', 'IsQuarterEnd', 'DaysFromStart', 'WeeksFromStart']

рЃћрЃАрЃћрЃюрЃў рЃљрЃарЃўрЃА рЃЕрЃЋрЃћрЃюрЃў рЃАрЃЋрЃћрЃбрЃћрЃЉрЃў рЃљрЃ«рЃџрЃљ.
рЃљрЃ«рЃџрЃљ рЃњрЃЋрЃўрЃюрЃЊрЃљ рЃарЃЮрЃЏ nan -рЃћрЃЉрЃў рЃЊрЃљрЃЋрЃцрЃўрЃЦрЃАрЃЮрЃЌ рЃЊрЃљ рЃљрЃАрЃћрЃЋрЃћ рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃА рЃЏрЃўрЃЋрЃћрЃЊрЃЮрЃЌ.

рЃ»рЃћрЃа рЃљрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃарЃЮрЃњрЃЮрЃа рЃњрЃљрЃЏрЃЮрЃўрЃДрЃБрЃарЃћрЃЉрЃљ рЃЊрЃљрЃбрЃљ.

рЃюрЃБ рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃюрЃљрЃ«рЃћ nan рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ markdown-рЃћрЃЉрЃерЃў рЃњрЃЋрЃљрЃЦ рЃарЃљрЃЊрЃњрЃљрЃю 2011-рЃўрЃЊрЃљрЃю рЃњрЃЋрЃљрЃЦ рЃЏрЃљрЃюрЃЊ рЃЊрЃљрЃбрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃљрЃЏрЃўрЃбрЃЮ рЃЏрЃљрЃюрЃЊ 
рЃарЃљрЃдрЃљрЃф рЃБрЃюрЃЊрЃљ рЃЏрЃЮрЃЋрЃБрЃцрЃўрЃЦрЃарЃЮ.

рЃЎрЃљрЃў рЃюрЃБ рЃ»рЃћрЃа рЃерЃћрЃЋрЃ«рЃћрЃЊрЃЮрЃЌ рЃЊрЃљ рЃњрЃЋрЃљрЃЦ рЃљрЃАрЃћрЃЌрЃў рЃарЃљрЃЏрЃћ:
MarkDown2	MarkDown2	310322	73.611025	float64
MarkDown4	MarkDown4	286603	67.984676	float64
MarkDown3	MarkDown3	284479	67.480845	float64
MarkDown1	MarkDown1	270889	64.257181	float64
MarkDown5	MarkDown5	270138	64.079038	float64

рЃљрЃЦ рЃЉрЃћрЃарЃЋрЃў nan рЃњрЃЋрЃљрЃЦ.

рЃњрЃЋрЃљрЃЦ рЃюрЃћрЃњрЃљрЃбрЃўрЃБрЃарЃў рЃАрЃћрЃўрЃџрЃћрЃЉрЃў рЃљрЃюрЃБ рЃгрЃљрЃњрЃћрЃЉрЃљрЃерЃў рЃарЃЮ рЃЏрЃўрЃ«рЃўрЃА рЃћрЃњ:
Negative sales range: $-4,988.94 to $-0.02

72 -рЃћ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃе рЃњрЃЋрЃљрЃЦ рЃФрЃљрЃџрЃўрЃљрЃю рЃЏрЃљрЃдрЃљрЃџрЃў рЃАрЃћрЃўрЃџрЃћрЃЉрЃў, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃњрЃљрЃЋрЃўрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃЮрЃЌ рЃарЃЮрЃЏ рЃћрЃарЃЌ рЃћрЃарЃЌ рЃ░рЃЮрЃџрЃўрЃЊрЃћрЃўрЃќрЃћ рЃ«рЃЊрЃћрЃЉрЃљ рЃћрЃњ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃерЃў рЃЋрЃћрЃа рЃњрЃљрЃЋрЃўрЃДрЃЋрЃљрЃюрЃЌ рЃЏрЃљрЃњрЃљрЃА. рЃюрЃБ рЃЌрЃљрЃю рЃњрЃљрЃЋрЃўрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃЮрЃЌ рЃарЃЮрЃЏ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃбрЃўрЃърЃўрЃА рЃАрЃбрЃЮрЃарЃћрЃЉрЃерЃў рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљрЃљ рЃАрЃљрЃерЃБрЃљрЃџрЃЮ рЃАрЃћрЃўрЃџрЃћрЃЉрЃўрЃА рЃЊрЃЮрЃюрЃћ.

рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃљрЃАрЃћ рЃЋрЃцрЃўрЃЦрЃарЃЮрЃЉ рЃарЃЮрЃЏ рЃЌрЃБ рЃ░рЃЮрЃџрЃўрЃЊрЃћрЃў рЃљрЃарЃљрЃљ рЃЊрЃљ рЃЏрЃљрЃўрЃюрЃф рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃўрЃљ рЃЏрЃљрЃерЃўрЃю рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃЮрЃЌ.

рЃДрЃЋрЃћрЃџрЃљрЃАрЃЌрЃЋрЃўрЃА рЃљрЃюрЃБ рЃДрЃЋрЃћрЃџрЃљ рЃАрЃЌрЃЮрЃарЃўрЃАрЃЌрЃЋрЃўрЃА рЃЋрЃЦрЃюрЃљрЃЌ рЃљрЃАрЃћрЃЌрЃў рЃарЃљрЃЏ рЃарЃЮ рЃЌрЃБ рЃФрЃљрЃљрЃљрЃю рЃЊрЃўрЃЊрЃўрЃљ рЃљрЃю рЃФрЃљрЃљрЃю рЃърЃљрЃбрЃљрЃарЃљ рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃЮрЃЌ. 
рЃљрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА рЃ»рЃћрЃа рЃЏрЃЮрЃЊрЃў рЃЋрЃўрЃърЃЮрЃЋрЃЮрЃЌ рЃбрЃарЃћрЃерЃ░рЃЮрЃџрЃЊрЃћрЃЉрЃў.
рЃЊрЃљ рЃЏрЃћрЃарЃћ рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃЮрЃЌ.

­ЪЊі CALCULATING ACTUAL THRESHOLDS BY STORE TYPE
============================================================
(Using train_with_dates - the actual dataset we have)

­ЪЈф STORE TYPE A
Sample size: 215,478 records
----------------------------------------
 80.0th percentile: $ 32,521.16 | 43,096 records above (20.00%)
 85.0th percentile: $ 40,311.11 | 32,322 records above (15.00%)
 90.0th percentile: $ 53,172.67 | 21,548 records above (10.00%)
 95.0th percentile: $ 74,285.73 | 10,774 records above (5.00%)
 97.5th percentile: $ 94,116.95 |  5,387 records above (2.50%)
 99.0th percentile: $126,175.36 |  2,155 records above (1.00%)
 99.5th percentile: $149,165.60 |  1,078 records above (0.50%)
 99.9th percentile: $184,007.45 |    216 records above (0.10%)

­ЪЊЁ Holiday vs Normal Sales for Store Type A:
Normal Sales   - Max: $356,867.25 | 99.5th: $148,205.09
Holiday Sales  - Max: $474,330.10 | 99.5th: $168,918.87

­ЪЈф STORE TYPE B
Sample size: 163,495 records
----------------------------------------
 80.0th percentile: $ 19,089.04 | 32,699 records above (20.00%)
 85.0th percentile: $ 24,038.83 | 24,525 records above (15.00%)
 90.0th percentile: $ 32,101.40 | 16,350 records above (10.00%)
 95.0th percentile: $ 46,279.64 |  8,175 records above (5.00%)
 97.5th percentile: $ 58,587.54 |  4,088 records above (2.50%)
 99.0th percentile: $ 77,292.35 |  1,635 records above (1.00%)
 99.5th percentile: $ 93,515.75 |    818 records above (0.50%)
 99.9th percentile: $129,147.93 |    164 records above (0.10%)

­ЪЊЁ Holiday vs Normal Sales for Store Type B:
Normal Sales   - Max: $406,988.63 | 99.5th: $ 92,397.70
Holiday Sales  - Max: $693,099.36 | 99.5th: $113,205.04

­ЪЈф STORE TYPE C
Sample size: 42,597 records
----------------------------------------
 80.0th percentile: $ 16,314.79 |  8,520 records above (20.00%)
 85.0th percentile: $ 20,140.12 |  6,390 records above (15.00%)
 90.0th percentile: $ 31,192.28 |  4,260 records above (10.00%)
 95.0th percentile: $ 46,833.02 |  2,130 records above (5.00%)
 97.5th percentile: $ 59,351.24 |  1,065 records above (2.50%)
 99.0th percentile: $ 72,103.37 |    426 records above (1.00%)
 99.5th percentile: $ 81,200.31 |    213 records above (0.50%)
 99.9th percentile: $ 95,654.76 |     43 records above (0.10%)

­ЪЊЁ Holiday vs Normal Sales for Store Type C:
Normal Sales   - Max: $112,152.35 | 99.5th: $ 80,865.55
Holiday Sales  - Max: $110,379.12 | 99.5th: $ 88,838.55



рЃ«рЃЮрЃЮрЃЮ рЃАрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃЮрЃЊ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃБрЃарЃћрЃЉрЃљ рЃћрЃА рЃбрЃарЃћрЃерЃ░рЃЮрЃџрЃЊрЃћрЃЉрЃўрЃА рЃњрЃљрЃбрЃћрЃАрЃбрЃЋрЃўрЃЌ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃњрЃЮрЃарЃф рЃерЃћрЃЋрЃ«рЃћрЃЊрЃЮрЃЌ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃбрЃўрЃърЃўрЃА рЃАрЃбрЃЮрЃарЃерЃў рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃњрЃЋрЃўрЃюрЃЊрЃљ.

рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ рЃљрЃЋрЃўрЃдрЃћрЃЉ рЃарЃћрЃЎрЃЮрЃЏрЃћрЃюрЃЊрЃўрЃарЃћрЃЉрЃБрЃџ рЃЌрЃарЃћрЃерЃ░рЃЮрЃџрЃЊрЃћрЃЉрЃА рЃЊрЃљ рЃњрЃљрЃЋрЃцрЃўрЃџрЃбрЃарЃљрЃЋ рЃЊрЃљрЃбрЃљрЃА.
­ЪЊі BEFORE outlier removal: 421,570 records

­ЪЈф Store Type A:
   Normal day outliers:  206 records
   Holiday outliers:     0 records
   Total outliers:       206 records (0.10%)

­ЪЈф Store Type B:
   Normal day outliers:  118 records
   Holiday outliers:     0 records
   Total outliers:       118 records (0.07%)

­ЪЈф Store Type C:
   Normal day outliers:  15 records
   Holiday outliers:     0 records
   Total outliers:       15 records (0.04%)

­ЪЊі AFTER outlier removal: 421,231 records
­ЪЌЉ№ИЈ Outliers removed: 339 records (0.08%)


рЃљрЃ«рЃџрЃљ рЃБрЃЎрЃЋрЃћ рЃерЃћрЃњрЃЋрЃўрЃФрЃџрЃўрЃљ nan-рЃћрЃЉрЃА рЃЏрЃўрЃЋрЃ«рЃћрЃЊрЃЮрЃЌ рЃЏрЃљрЃарЃљ
рЃарЃљрЃ«рЃљрЃю рЃћрЃ«рЃљ рЃЎрЃљрЃў рЃЉрЃћрЃЋрЃарЃў рЃЊрЃљрЃбрЃљ рЃњрЃЋрЃљрЃЦ рЃЏрЃЮрЃЊрЃў рЃ»рЃћрЃа рЃАрЃљрЃћрЃарЃЌрЃЮрЃЊ рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃЮрЃЌ markdown-рЃћрЃЉрЃў рЃЊрЃљ nan-рЃћрЃЉрЃў рЃљрЃдрЃљрЃа рЃњрЃЋрЃћрЃЦрЃюрЃћрЃЉрЃљ рЃЊрЃљ рЃћрЃАрЃћ рЃерЃћрЃЋрЃ«рЃћрЃЊрЃЮрЃЌ рЃЊрЃљ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮрЃЌ.

рЃћрЃА рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮ 60% missing рЃЊрЃљрЃбрЃљрЃљ рЃЊрЃљ рЃЏрЃўрЃАрЃў рЃерЃћрЃЋрЃАрЃћрЃЉрЃљ рЃЎрЃљрЃў рЃАрЃљрЃЕрЃљрЃџрЃўрЃЕрЃЮ рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃЊрЃљ рЃЏрЃЮрЃЊрЃў рЃ»рЃћрЃа рЃљрЃа рЃњрЃЋрЃўрЃюрЃЊрЃљ.

Data columns (total 24 columns):
 #   Column          Non-Null Count   Dtype         
---  ------          --------------   -----         
 0   Store           421231 non-null  int64         
 1   Dept            421231 non-null  int64         
 2   Date            421231 non-null  datetime64[ns]
 3   Weekly_Sales    421231 non-null  float64       
 4   Type            421231 non-null  object        
 5   Size            421231 non-null  int64         
 6   Temperature     421231 non-null  float64       
 7   Fuel_Price      421231 non-null  float64       
 8   CPI             421231 non-null  float64       
 9   Unemployment    421231 non-null  float64       
 10  IsHoliday       421231 non-null  bool          
 11  Year            421231 non-null  int32         
 12  Month           421231 non-null  int32         
 13  Day             421231 non-null  int32         
 14  DayOfWeek       421231 non-null  int32         
 15  WeekOfYear      421231 non-null  UInt32        
 16  Quarter         421231 non-null  int32         
 17  IsWeekend       421231 non-null  int64         
 18  IsMonthStart    421231 non-null  int64         
 19  IsMonthEnd      421231 non-null  int64         
 20  IsQuarterStart  421231 non-null  int64         
 21  IsQuarterEnd    421231 non-null  int64         
 22  DaysFromStart   421231 non-null  int64         
 23  WeeksFromStart  421231 non-null  int64  

 рЃЎрЃљрЃў 24 column рЃњрЃЋрЃљрЃЦ рЃЏрЃћрЃЏрЃњрЃЮрЃюрЃў рЃЎрЃљрЃўрЃљ рЃ»рЃћрЃа.

 рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃЎрЃљрЃбрЃћрЃњрЃЮрЃарЃўрЃБрЃџрЃћрЃЉрЃА рЃЏрЃўрЃЋрЃ«рЃћрЃЊрЃЮрЃЌ рЃЊрЃљ рЃЏрЃљрЃдрЃљрЃџрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃўрЃА рЃЏрЃЦрЃЮрЃюрЃћрЃћрЃЉрЃў рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃЮрЃЌ.

 1№ИЈРЃБ CATEGORICAL VARIABLES:
   Categorical columns: ['Type']
   Store Type distribution: {'A': 215272, 'B': 163377, 'C': 42582}

2№ИЈРЃБ NUMERICAL VARIABLES SCALING:
   Store       : Range [    1.00,    45.00] | Mean:    22.21 | Std:    12.79
   Dept        : Range [    1.00,    99.00] | Mean:    44.24 | Std:    30.48
   Size        : Range [34875.00, 219622.00] | Mean: 136706.14 | Std: 60979.97
   Temperature : Range [   -2.06,   100.14] | Mean:    60.10 | Std:    18.45
   Fuel_Price  : Range [    2.47,     4.47] | Mean:     3.36 | Std:     0.46
   CPI         : Range [  126.06,   227.23] | Mean:   171.21 | Std:    39.16
   Unemployment: Range [    3.88,    14.31] | Mean:     7.96 | Std:     1.86

3№ИЈРЃБ HIGH CORRELATION CHECK:
   High correlations found (>0.8):
   - Year Рєћ DaysFromStart: 0.942
   - Year Рєћ WeeksFromStart: 0.942
   - Month Рєћ WeekOfYear: 0.996
   - Month Рєћ Quarter: 0.967
   - WeekOfYear Рєћ Quarter: 0.964
   - IsMonthStart Рєћ IsQuarterStart: 0.863
   - DaysFromStart Рєћ WeeksFromStart: 1.000


рЃюрЃБ рЃљрЃЏрЃЮрЃЋрЃўрЃдрЃЮрЃЌ рЃЏрЃљрЃдрЃљрЃџрЃў рЃЎрЃЮрЃарЃћрЃџрЃљрЃфрЃўрЃўрЃА рЃЏрЃЦрЃЮрЃюрЃћрЃћрЃЉрЃў: 
DaysFromStart, WeekOfYear, Quarter, Year,
Day, IsQuarterStart, IsQuarterEnd

REMAINING FEATURES (17 total) 
рЃљрЃ«рЃџрЃљ рЃЎрЃљрЃбрЃћрЃњрЃЮрЃарЃўрЃБрЃџрЃўрЃф рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃЮрЃЌ рЃЊрЃљ рЃћрЃњрЃљрЃљ.One-Hot Encoding рЃарЃљрЃЊрЃњрЃљрЃю 3 рЃфрЃљрЃџрЃў рЃњрЃЋрЃљрЃЦ A, b,c.

  A Рєњ 0 (215,272 records)
   B Рєњ 1 (163,377 records)
   C Рєњ 2 (42,582 records)

   New columns: ['Store', 'Dept', 'Date', 'Weekly_Sales', 'Size', 'Temperature', 'Fuel_Price', 'CPI', 'Unemployment', 'IsHoliday', 'Month', 'DayOfWeek', 'IsWeekend', 'IsMonthStart', 'IsMonthEnd', 'WeeksFromStart', 'Type_A', 'Type_B', 'Type_C']

   19 рЃЦрЃЮрЃџрЃБрЃЏрЃў рЃњрЃЋрЃљрЃЦ рЃћрЃ«рЃљ.

### рЃЎрЃљрЃў рЃљрЃ«рЃџрЃљ рЃњрЃљрЃЊрЃљрЃЋрЃћрЃЊрЃўрЃЌ рЃЊрЃљрЃбрЃўрЃА рЃњрЃљрЃДрЃЮрЃцрЃљрЃќрЃћ.

рЃарЃљрЃЊрЃњрЃљрЃю time series рЃљрЃарЃўрЃА рЃљрЃЦ рЃБрЃцрЃарЃЮ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃљрЃЊ рЃ«рЃЊрЃћрЃЉрЃљ рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃў.
рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЊрЃљрЃбрЃўрЃА рЃњрЃљрЃДрЃЮрЃцрЃљрЃф рЃарЃЌрЃБрЃџрЃўрЃљ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ.
рЃћрЃАрЃћ рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа 80/10/10, рЃњрЃљрЃДрЃЮрЃцрЃљ рЃљрЃарЃљрЃАрЃгрЃЮрЃарЃўрЃљ рЃарЃљрЃЊрЃњрЃљрЃю рЃЦрЃарЃЮрЃюрЃЮрЃџрЃЮрЃњрЃўрЃљрЃА рЃљрЃЦрЃЋрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ.

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃћрЃА рЃЎрЃљрЃў рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃўрЃљ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ рЃњрЃљрЃЋрЃАрЃърЃџрЃўрЃбрЃљрЃЋ рЃЊрЃљрЃбрЃљрЃА рЃЊрЃљ рЃЌрЃўрЃЌрЃЮрЃерЃў рЃЎрЃЋрЃўрЃарЃћрЃЉрЃўрЃА рЃЏрЃўрЃ«рЃћрЃЊрЃЋрЃўрЃЌ рЃЏрЃЮрЃЋрЃБрЃДрЃарЃў рЃЌрЃљрЃЋрЃА рЃљрЃАрЃћрЃЌрЃў рЃърЃарЃўрЃюрЃфрЃўрЃърЃўрЃЌ:

ALL Store-Dept combinations:
Train: [Week1 Рєњ Week114]  (80% of weeks)
Val:   [Week115 Рєњ Week128] (10% of weeks)  
Test:  [Week129 Рєњ Week143] (10% of weeks)

рЃљрЃЦ рЃљрЃЏрЃўрЃЌрЃў рЃерЃћрЃЋрЃўрЃюрЃљрЃ«рЃљрЃЋрЃЌ рЃЦрЃарЃЮрЃюрЃЮрЃџрЃЮрЃњрЃўрЃљрЃА.
DATE CUTOFFS:
   Train: 2010-02-05 00:00:00 to 2012-04-06 00:00:00
   Val:   2012-04-13 00:00:00 to 2012-07-13 00:00:00
   Test:  2012-07-20 00:00:00 to 2012-10-26 00:00:00

рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃўрЃАрЃЌрЃЋрЃўрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ train рЃЊрЃљ val.

рЃЏрЃљрЃњрЃарЃљрЃЏ рЃбрЃћрЃАрЃбрЃўрЃАрЃЌрЃЋрЃўрЃА рЃБрЃцрЃарЃЮ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў рЃўрЃАрЃљрЃљ рЃарЃЮ рЃћрЃњрЃарЃћрЃЋрЃћ test-рЃќрЃћ рЃЌрЃБ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃћрЃЌ рЃЊрЃљрЃбрЃљ рЃџрЃўрЃЦрЃўрЃ»рЃў рЃњрЃЋрЃћрЃЦрЃюрЃћрЃЉрЃљ рЃЊрЃљ рЃљрЃЏрЃўрЃБрЃбрЃЮрЃЏ рЃњрЃЋрЃўрЃюрЃЊрЃљ рЃарЃЮрЃЏ train+ val рЃЊрЃљ test рЃњрЃЋрЃЦрЃЮрЃюрЃЊрЃћрЃА.

рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃўрЃАрЃЌрЃЋрЃўрЃА рЃљрЃЋрЃўрЃдрЃЮрЃЌ xgboost рЃўрЃАрЃћрЃЋрЃћ рЃЊрЃљ рЃћрЃАрЃћ  n_estimators=200,           # More trees
            max_depth=8,                # Deeper trees  
            learning_rate=0.05,         # Lower learning rate
            subsample=0.8,


IMPROVED RESULTS:
   Train: MAE=$2,946.87 | RMSE=$5,377.46 | WMAE=$3,107.74
   Val:   MAE=$3,943.09 | RMSE=$6,816.74 | WMAE=$3,943.09
 
рЃЎрЃљрЃў рЃюрЃБ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃерЃћрЃЊрЃћрЃњрЃў рЃњрЃЋрЃљрЃЦ рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃўрЃАрЃљрЃА рЃЋрЃўрЃЊрЃарЃћ рЃърЃўрЃарЃЋрЃћрЃџ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃерЃў., рЃљрЃ«рЃџрЃљ рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃбрЃћрЃАрЃбрЃўрЃюрЃњрЃў рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃљрЃюрЃБ train + val рЃЊрЃљ test.

TOP 10 FEATURES (Improved Model):
    1. Dept           : 0.3925
    2. Type_Encoded   : 0.1816
    3. Size           : 0.1381
    4. IsHoliday      : 0.0686
    5. Store          : 0.0634
    6. Month          : 0.0496
    7. CPI            : 0.0274
    8. IsMonthEnd     : 0.0261
    9. Unemployment   : 0.0220
   10. WeeksFromStart : 0.0163



рЃљрЃ«рЃџрЃљ рЃўрЃњрЃўрЃЋрЃћ рЃюрЃљрЃўрЃарЃљрЃЊ рЃЏрЃЮрЃњрЃЋрЃўрЃгрЃћрЃЋрЃА рЃЊрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉрЃљ рЃЊрЃљ рЃЏрЃћрЃарЃћ рЃбрЃћрЃАрЃбрЃАрЃћрЃбрЃДрЃќрЃћ рЃњрЃљрЃерЃЋрЃћрЃЉрЃљ, рЃюрЃБ рЃљрЃЏрЃўрЃА рЃЏрЃўрЃќрЃћрЃќрЃў рЃљрЃарЃўрЃА рЃўрЃА рЃарЃЮрЃЏ рЃЊрЃљрЃбрЃљ рЃџрЃўрЃЦрЃўрЃ»рЃў рЃњрЃЋрЃљрЃЦ рЃЊрЃљ рЃљрЃа рЃњрЃЋрЃўрЃюрЃЊрЃљ рЃћрЃњ. 

 Original Train: 335,453 records
   Original Val:   41,378 records
   Combined Train: 376,831 records
   Test Set:       44,400 records

FINAL TESTING RESULTS:
   Training (Train+Val): MAE=$2,896.51 | RMSE=$5,242.54 | WMAE=$3,045.81
   Testing  (Test only): MAE=$2,968.85 | RMSE=$4,959.53 | WMAE=$3,049.17

TOP 10 MOST IMPORTANT FEATURES:
    1. Dept           : 0.4108
    2. Type_Encoded   : 0.1807
    3. Size           : 0.1415
    4. Store          : 0.0657
    5. IsHoliday      : 0.0630
    6. Month          : 0.0455
    7. CPI            : 0.0269
    8. Unemployment   : 0.0210
    9. IsMonthEnd     : 0.0187
   10. WeeksFromStart : 0.0124

рЃюрЃБ рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃЊрЃљ рЃЊрЃљрЃЪрЃћ рЃЋрЃўрЃЊрЃарЃћ рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃерЃў рЃўрЃДрЃЮ рЃљрЃџрЃЉрЃљрЃЌ рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃБрЃцрЃарЃЮ рЃЏрЃћрЃбрЃў рЃЊрЃљрЃбрЃљ рЃњрЃЋрЃљрЃЦ, рЃЦрЃарЃЮрЃюрЃЮрЃџрЃЮрЃњрЃўрЃБрЃарЃљрЃЊрЃљрЃф рЃБрЃЎрЃћрЃЌрЃћрЃАрЃўрЃљ.

рЃљрЃАрЃћрЃЋрЃћ рЃљрЃЦ рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃБрЃДрЃБрЃарЃћрЃЉ рЃФрЃљрЃџрЃўрЃљрЃю рЃЎрЃљрЃарЃњрЃў рЃ»рЃћрЃюрЃћрЃарЃљрЃџрЃўрЃќрЃљрЃфрЃўрЃљ рЃњрЃЋрЃљрЃЦ. 

Training (Train+Val): MAE=$2,896.51
Testing  (Test only): MAE=$2,968.85
рЃљрЃАрЃћрЃЋрЃћ рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃБрЃЎрЃћрЃЌрЃАрЃћрЃў рЃерЃћрЃЊрЃћрЃњрЃў рЃњрЃЋрЃљрЃЦ рЃЋрЃўрЃЊрЃарЃћ рЃърЃўрЃарЃЋрЃћрЃџ рЃћрЃЦрЃАрЃърЃћрЃарЃЏрЃўрЃћрЃюрЃбрЃерЃў.

Experiment 1 Test WMAE: $4,163.80
Final Test WMAE:        $3,049.17

рЃЕрЃћрЃЏрЃў рЃљрЃќрЃарЃўрЃЌ рЃЎрЃљрЃарЃњрЃўрЃљ рЃ»рЃћрЃа рЃ»рЃћрЃарЃЮрЃЉрЃўрЃЌ рЃЎрЃљрЃў рЃерЃћрЃЊрЃћрЃњрЃўрЃљ.

рЃюрЃБ рЃљрЃЦрЃљрЃф рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ рЃўрЃАрЃљрЃљ рЃарЃЮ рЃњрЃўрЃЌрЃ░рЃБрЃЉрЃќрЃћ рЃљрЃа рЃљрЃЕрЃЋрЃћрЃюрЃћрЃЉрЃА рЃЌрЃЮрЃарЃћ рЃўрЃАрЃћ рЃарЃЮ рЃЊрЃљрЃцрЃБрЃџрЃЮ рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА рЃЊрЃљ рЃњрЃљрЃюрЃљрЃ«рЃћрЃЉрЃА notebook-рЃА.


# experiment_3_k.ipynb

рЃЎрЃљрЃў рЃБрЃЉрЃарЃљрЃџрЃЮрЃЊ рЃЏрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃћрЃЉрЃА future рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ stores, рЃЊрЃљ train рЃарЃЮрЃЏ рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃЮ 
рЃЮрЃдрЃЮрЃюрЃЊ рЃЏрЃўрЃЋрЃўрЃдрЃЮ рЃарЃљрЃф рЃерЃћрЃўрЃџрЃћрЃЉрЃљ рЃЉрЃћрЃЋрЃарЃў рЃЊрЃљ рЃЎрЃљрЃарЃњрЃў рЃцрЃўрЃЕрЃћрЃарЃў рЃЊрЃћрЃўрЃбрЃћрЃЉрЃўрЃЊрЃљрЃю рЃарЃљ рЃерЃћрЃЊрЃћрЃњрЃА рЃЊрЃљрЃЋрЃЊрЃћрЃЉ. 
рЃЌрЃљрЃю рЃџрЃљрЃњрЃўрЃюрЃњ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃА рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ рЃљрЃюрЃБ рЃФрЃЋрЃћрЃџрЃў рЃЊрЃљрЃбрЃљрЃА рЃњрЃљрЃЋрЃџрЃћрЃюрЃљ рЃарЃЮрЃЏ рЃЦрЃЮрЃюрЃЊрЃћрЃА рЃарЃљ рЃћрЃњрЃћрЃЌрЃА.
рЃљрЃАрЃћрЃЋрЃћ рЃЋрЃцрЃўрЃЦрЃарЃЮрЃЉ рЃћрЃарЃЌрЃћрЃарЃЌрЃў рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃўрЃА facebook prophet-рЃўрЃА рЃњрЃљрЃбрЃћрЃАрЃбрЃЋрЃљрЃА.

рЃюрЃБ prophet- рЃЎрЃљрЃў рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃўрЃљ рЃљрЃЊрЃарЃћрЃф рЃњрЃљрЃЏрЃЮрЃЏрЃўрЃДрЃћрЃюрЃћрЃЉрЃўрЃљ. рЃљрЃЏ рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃљрЃерЃў basic prophets- рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ рЃЊрЃљ рЃљрЃарЃљ рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџрЃА. рЃўрЃЊрЃћрЃљрЃерЃў рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃюрЃљрЃ«рЃћ рЃюрЃћрЃўрЃарЃЮрЃюрЃБрЃџрЃў рЃБрЃцрЃарЃЮ рЃБрЃЎрЃћрЃЌрЃћрЃА рЃерЃћрЃЊрЃћрЃњрЃћрЃЉрЃА рЃЊрЃћрЃЉрЃАрЃЮ рЃЏрЃљрЃарЃљ рЃћрЃАрЃћрЃф рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃќрЃћ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃ»рЃћрЃа рЃћрЃА рЃўрЃДрЃЮрЃА. 

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/2

### Cyclical encodings, Time since reference
 рЃўрЃЊрЃћрЃљрЃерЃў рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћрЃЉ Cyclical encodings-рЃћрЃћрЃЉрЃА рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃюрЃљрЃ«рЃћ рЃАрЃўрЃюрЃБрЃАрЃў рЃЊрЃљ рЃЎрЃЮрЃАрЃўрЃюрЃБрЃАрЃћрЃЉрЃў рЃарЃљрЃдрЃљрЃф рЃЏрЃ«рЃарЃўрЃЋ рЃерЃћрЃўрЃџрЃћрЃЉрЃљ рЃЎрЃљрЃў рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃБ рЃњрЃљрЃЏрЃЮрЃЊрЃњрЃћрЃА рЃЊрЃљ рЃљрЃАрЃћрЃЋрЃћ, рЃарЃљрЃЏрЃЊрЃћрЃюрЃў рЃЊрЃарЃЮ рЃњрЃљрЃЋрЃўрЃЊрЃљ рЃЊрЃљрЃгрЃДрЃћрЃЉрЃўрЃЊрЃљрЃю рЃљрЃю рЃЏрЃАрЃњрЃљрЃЋрЃАрЃў рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃўрЃф рЃАрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃЮрЃљ рЃњрЃљрЃАрЃљрЃбрЃћрЃАрЃбрЃљрЃЊ.

рЃљрЃЏрЃљрЃАрЃЌрЃљрЃю рЃћрЃарЃЌрЃљрЃЊ рЃЋрЃљрЃЏрЃљрЃбрЃћрЃЉ lagging рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃА рЃљрЃюрЃБ, рЃўрЃАрЃбрЃЮрЃарЃўрЃБрЃџрЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљ рЃарЃЮрЃЏ рЃерЃћрЃФрЃџрЃЮрЃА.  рЃЏрЃљрЃњрЃљрЃџрЃўрЃЌрЃљрЃЊ рЃћрЃАрЃћрЃЌрЃћрЃЉрЃў
Weekly_Sales_lag_1, 2, 4, 8, 13, 52. рЃћрЃАрЃћрЃюрЃў рЃФрЃЋрЃћрЃџ рЃЏрЃЮрЃюрЃљрЃфрЃћрЃЏрЃћрЃЉрЃќрЃћ рЃгрЃЋрЃЊрЃЮрЃЏрЃљрЃе рЃЊрЃљрЃћрЃ«рЃЏрЃљрЃарЃћрЃЉрЃљ.
Weekly_Sales_rolling_mean_4 ,12 ..  рЃћрЃАрЃћрЃюрЃў рЃърЃарЃЮрЃАрЃбрЃљ рЃћрЃЋрЃћрЃарЃўрЃ»рЃћрЃЉрЃўрЃљ.

рЃ«рЃЮ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃЋрЃўрЃцрЃўрЃЦрЃарЃћ рЃгрЃўрЃюрЃљ рЃгрЃџрЃўрЃА рЃўрЃњрЃўрЃЋрЃћ рЃЊрЃдрЃўрЃА рЃЊрЃљрЃбрЃљрЃА рЃњрЃљрЃЋрЃўрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃћрЃЉ рЃЌрЃЦрЃЮ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА рЃЏрЃљрЃарЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ 2 рЃгрЃџрЃўрЃА рЃЊрЃљрЃбрЃљ рЃњрЃЋрЃљрЃЦ рЃљрЃЏрЃўрЃбрЃЮ рЃљрЃќрЃарЃў рЃљрЃа рЃљрЃЦ рЃЏрЃљрЃњрЃљрЃА.

рЃЎрЃљрЃў рЃњрЃљрЃЋрЃБрЃерЃЋрЃў рЃЊрЃљ рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў рЃћрЃ«рЃљ рЃерЃћрЃЋрЃ«рЃћрЃЊрЃЮрЃЌ рЃЊрЃљ рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃарЃЮрЃњрЃЮрЃарЃўрЃљ.

рЃ░рЃЏрЃЏ рЃЏрЃЮрЃЊрЃў рЃ»рЃћрЃа xgboost-рЃќрЃћ рЃЋрЃюрЃљрЃ«рЃљрЃЋ рЃЊрЃљ рЃЏрЃћрЃарЃћ prophet-рЃќрЃћ 
рЃљрЃЏрЃ»рЃћрЃарЃљрЃЊ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃўрЃА рЃЊрЃљ рЃбрЃљрЃарЃћрЃўрЃюрЃўрЃА рЃњрЃЋрЃћрЃЦрЃюрЃћрЃЉрЃљ рЃЏрЃљрЃўрЃюрЃф рЃЉрЃЮрЃџрЃЮрЃА рЃўрЃњрЃўрЃЋрЃћ рЃЏрЃўрЃгрЃћрЃЋрЃА рЃбрЃћрЃАрЃбрЃќрЃћ рЃЊрЃљ рЃљрЃЏрЃўрЃбрЃЮ рЃљрЃдрЃљрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ рЃћрЃ«рЃљ

Date Features: 65 features
  Examples: ['Weekly_Sales', 'Year', 'Month']

Holiday Features: 7 features
  Examples: ['IsHoliday', 'IsSuperBowlWeek', 'IsLaborDayWeek']

Lag Features: 6 features
  Examples: ['Weekly_Sales_lag_1', 'Weekly_Sales_lag_2', 'Weekly_Sales_lag_3']

Rolling Features: 16 features
  Examples: ['Weekly_Sales_rolling_mean_4', 'Weekly_Sales_rolling_std_4', 'Weekly_Sales_rolling_min_4']

EWM Features: 3 features
  Examples: ['Weekly_Sales_ewm_0.1', 'Weekly_Sales_ewm_0.3', 'Weekly_Sales_ewm_0.5']

рЃћрЃ«рЃљ рЃерЃћрЃЋрЃљрЃЏрЃЮрЃгрЃЏрЃћрЃЉ рЃЌрЃБ nan-рЃћрЃЉрЃў рЃЏрЃљрЃЦ. 

рЃюрЃБ nan-рЃћрЃЉрЃўрЃф рЃњрЃЋрЃљрЃЦ рЃЌрЃљрЃЋрЃўрЃАрЃЌрЃљрЃЋрЃљрЃЊ.

­ЪЊі Overall NaN Summary:
   Total cells: 31,617,750
   Total NaNs: 325,131
   NaN percentage: 1.03%

­ЪЊІ Columns with NaNs: 14 out of 75

­ЪћЇ Detailed NaN Analysis by Column:
============================================================
                          Column  NaN_Count  NaN_Percentage Data_Type
Weekly_Sales_same_week_prev_year     159167       37.755770   float64
             Weekly_Sales_lag_12      38615        9.159807   float64
     Weekly_Sales_quarterly_diff      38615        9.159807   float64
              Weekly_Sales_lag_8      25966        6.159357   float64
              Weekly_Sales_lag_4      13134        3.115497   float64
       Weekly_Sales_monthly_diff      13134        3.115497   float64
              Weekly_Sales_lag_3       9889        2.345755   float64
              Weekly_Sales_lag_2       6625        1.571507   float64
              Weekly_Sales_lag_1       3331        0.790142   float64
      Weekly_Sales_rolling_std_4       3331        0.790142   float64
     Weekly_Sales_rolling_std_26       3331        0.790142   float64
     Weekly_Sales_rolling_std_12       3331        0.790142   float64
      Weekly_Sales_rolling_std_8       3331        0.790142   float64
         Weekly_Sales_trend_diff       3331        0.790142   float64

рЃюрЃБ Weekly_Sales_same_week_prev_year рЃљрЃЏрЃљрЃА рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃћрЃЉ рЃЊрЃљ рЃЊрЃљрЃюрЃљрЃарЃЕрЃћрЃюрЃћрЃЉрЃА рЃЊрЃљрЃЋрЃцрЃўрЃЦрЃАрЃљрЃЋ рЃЊрЃљ рЃЋрЃћрЃфрЃЊрЃћрЃЉрЃў рЃњрЃљрЃЋрЃљрЃАрЃгрЃЮрЃарЃЮ.

рЃюрЃБ рЃљрЃџрЃЉрЃљрЃЌ рЃ»рЃЮрЃЉрЃўрЃљ рЃЊрЃљрЃАрЃљрЃгрЃДрЃўрЃАрЃћрЃЉрЃў рЃЌрЃБрЃљ 0 рЃћрЃЉрЃўрЃЌ рЃерЃћрЃЋрЃљрЃЋрЃАрЃў рЃўрЃЏрЃўрЃбрЃЮрЃарЃЮ рЃЏрЃљрЃюрЃљрЃЏрЃЊрЃћ рЃЊрЃљрЃбрЃљ рЃљрЃа рЃљрЃарЃўрЃА. 

рЃЋрЃАрЃўрЃЮ nan-рЃћрЃЉрЃўрЃАрЃњрЃљрЃю рЃњрЃљрЃЋрЃљрЃАрЃБрЃцрЃЌрЃљрЃЋрЃћ Total NaNs remaining: 0

 Data Quality Report:
   РюЁ Total NaNs: 0
   РюЁ Infinite values: 0
   РюЁ Negative sales: 1,285 (0.30%)
   РюЁ Duplicate rows: 0
   РюЁ Date issues: 0

рЃарЃЮрЃњрЃЮрЃарЃф рЃЏрЃўрЃЋрЃ«рЃЋрЃЊрЃў negative sales рЃљрЃарЃўрЃА рЃћрЃАрЃћрЃЌрЃБ рЃарЃљрЃЏрЃћ:
Customer bought $100 worth of items last week Рєњ +$100 sales
Customer returned $30 worth of items this week Рєњ -$30 sales
Net effect: Week 1: +$100, Week 2: -$30

рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃњрЃљрЃЋрЃгрЃЏрЃўрЃюрЃЊрЃЮрЃЌ outliereb-рЃўрЃАрЃњрЃљрЃю.

рЃюрЃБ рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ рЃљрЃЏрЃўрЃАрЃЌрЃЋрЃўрЃА рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃЏрЃћрЃЌрЃЮрЃЊрЃћрЃЉрЃА:
IQR  - Q1 = 25th percentile (first quartile)
Q3 = 75th percentile (third quartile)  
IQR = Q3 - Q1

Lower Bound = Q1 - (multiplier ├Ќ IQR)
Upper Bound = Q3 + (multiplier ├Ќ IQR)

Any value outside these bounds = outlier

 Z-Score Method - Z-Score = (Value - Mean) / Standard Deviation

If |Z-Score| > threshold (usually 2 or 3), it's an outlier

Percentile Method - Keep only values between 0.5th percentile and 99.5th percentile
Remove the most extreme 1% of data (0.5% from each tail)

рЃЎрЃљрЃў рЃЏрЃљрЃњрЃарЃљрЃЏ рЃљрЃЦ рЃћрЃарЃЌрЃў рЃарЃљрЃЏрЃћ рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЋрЃўрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃЮрЃЌ. рЃарЃЮрЃфрЃљ holiday- рЃЏрЃљрЃерЃўрЃю рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃЏрЃћрЃбрЃў рЃњрЃљрЃДрЃўрЃЊрЃЋрЃљрЃљ рЃљрЃЏрЃўрЃбрЃЮ holiday-рЃћрЃЉрЃўрЃЌрЃЋрЃўрЃА рЃфрЃљрЃџрЃЎрЃћ рЃБрЃюрЃЊрЃљ рЃњрЃљрЃЋрЃцрЃўрЃџрЃбрЃарЃЮрЃЌ.
рЃљрЃюрЃБ рЃњрЃљрЃЋрЃДрЃЮрЃцрЃЌ рЃЮрЃарЃљрЃЊ рЃЊрЃљ рЃфрЃљрЃџ рЃфрЃљрЃџрЃЎрЃћ рЃЊрЃљрЃЋрЃЌрЃЋрЃџрЃў рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃА.

(рЃ░рЃЏрЃЏ, рЃљрЃЦ рЃЏрЃЮрЃЏрЃўрЃЋрЃўрЃЊрЃљ рЃўрЃЊрЃћрЃљ рЃарЃЮрЃЏ рЃЉрЃЮрЃџрЃЮрЃерЃў рЃарЃЮ рЃЊрЃљрЃЋрЃўрЃБрЃгрЃДрЃћрЃЉ рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃў рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃюрЃЋрЃћ рЃЮрЃарЃљрЃЊ рЃњрЃљрЃЋрЃДрЃЮ рЃЊрЃљ рЃ░рЃЮрЃџрЃўрЃЊрЃћрЃўрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА рЃфрЃљрЃџрЃЎрЃћ рЃЊрЃљрЃЋрЃЊрЃЮ рЃцрЃарЃћрЃЊрЃўрЃЦрЃерЃћрЃюрЃў рЃЊрЃљ рЃљрЃарЃљрЃ░рЃЮрЃџрЃўрЃЊрЃћрЃўрЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА 
рЃфрЃљрЃџрЃЎрЃћ рЃЏрЃљрЃарЃљ рЃЏрЃљрЃЏрЃћрЃюрЃб рЃгрЃўрЃюрЃљ рЃЊрЃдрЃўрЃА рЃЊрЃљрЃбрЃљрЃА рЃњрЃљрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃћрЃЉрЃљрЃф рЃЊрЃљ рЃўрЃАрЃбрЃЮрЃарЃўрЃБрЃџрЃў рЃЊрЃљрЃбрЃљрЃА рЃњрЃљрЃЌрЃЋрЃљрЃџрЃўрЃАрЃгрЃўрЃюрЃћрЃЉрЃљрЃф рЃЎрЃљрЃўрЃљ рЃЊрЃљ рЃЏрЃљрЃерЃўрЃю рЃћрЃњ рЃљрЃдрЃљрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃљ, рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃерЃћрЃўрЃџрЃћрЃЉрЃљ рЃћрЃњрЃарЃћрЃф рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮ)

Holiday Outlier Detection Results:
   IQR bounds: $-55,254 to $78,521
   Percentile bounds: $-4 to $193,132
   Z-score threshold: 3.5
   Negative threshold: $-15,000
     iqr: 897 outliers (3.02%)
     percentile: 150 outliers (0.51%)
     z_score: 339 outliers (1.14%)
     extreme_negative: 0 outliers (0.00%)

   Non-Holiday Outlier Detection Results:
   IQR bounds: $-43,049 to $65,260
   Percentile bounds: $-3 to $150,350
   Z-score threshold: 3.0
   Negative threshold: $-8,000
     iqr: 16,762 outliers (4.28%)
     percentile: 1,958 outliers (0.50%)
     z_score: 8,516 outliers (2.17%)
     extreme_negative: 0 outliers (0.00%)

рЃљрЃЏрЃљрЃАрЃЮрЃЉрЃљрЃерЃў рЃњрЃљрЃўрЃцрЃўрЃџрЃбрЃарЃљ рЃЊрЃљ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌрЃў рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃў рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃћрЃЌ.

рЃЮрЃЎрЃћрЃў рЃћрЃ«рЃљ рЃњрЃљрЃЋрЃАрЃърЃџрЃўрЃбрЃЮрЃЌ 80/20 рЃќрЃћ рЃЮрЃдрЃЮрЃюрЃЊ рЃарЃЮрЃњрЃЮрЃарЃф рЃбрЃљрЃўрЃЏ рЃАрЃћрЃарЃўрЃћрЃА рЃЊрЃљрЃбрЃљ рЃЊрЃљ рЃљрЃарЃљ рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋрЃў.
РюЁ Training data saved: 321,636 records
РюЁ Validation data saved: 82,275 records
рЃ«рЃЮ рЃћрЃА 80/20 рЃАрЃърЃџрЃўрЃбрЃў рЃЎрЃљрЃўрЃљ рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃљрЃЦ рЃљрЃарЃўрЃА 421 000 рЃфрЃљрЃџрЃў , рЃ«рЃЮрЃџрЃЮ рЃбрЃћрЃАрЃб рЃАрЃћрЃбрЃерЃўрЃА рЃљрЃарЃўрЃА 115 000 рЃ«рЃЮрЃЊрЃљ рЃЊрЃљрЃљрЃ«рЃџрЃЮрЃћрЃЉрЃўрЃЌ 80/20 рЃќрЃћрЃљ. 
рЃ»рЃћрЃа xgboost-рЃА рЃЊрЃљрЃЋрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉ рЃЊрЃљ рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃљрЃЉрЃљ рЃарЃљ рЃерЃћрЃЊрЃћрЃњрЃў рЃњрЃЋрЃљрЃЦ.
71 рЃцрЃўрЃЕрЃћрЃарЃў рЃЎрЃў рЃњрЃЋрЃљрЃЦ.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/2/runs/912678876c794318881e59358327994d

 ­Ъј» KEY METRICS (Validation Set):
     WMAE (Walmart Competition Metric): $94.20
     MAE: $91.00
     RMSE: $191.05
     R┬▓: 0.9998

рЃћрЃБрЃц рЃљрЃЦ рЃарЃљрЃдрЃљрЃф рЃФрЃљрЃљрЃю рЃюрЃўрЃбрЃЮ рЃЏрЃЮрЃ«рЃЊрЃљ рЃАрЃўрЃАрЃБрЃџрЃћрЃџрЃћ рЃерЃћрЃЊрЃћрЃњрЃў рЃЊрЃљрЃЊрЃЮ рЃарЃљрЃдрЃљрЃф рЃерЃћрЃЏрЃћрЃерЃљрЃџрЃљ.
рЃерЃћрЃЏрЃћрЃерЃљрЃџрЃљ рЃарЃЮ рЃЊрЃљрЃбрЃљ рЃАрЃърЃџрЃўрЃбрЃў рЃЌрЃљрЃЋрЃўрЃА рЃЊрЃарЃЮрЃќрЃћ рЃљрЃа рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃћ. рЃћрЃ░рЃ░ рЃљрЃ«рЃџрЃўрЃЊрЃљрЃю рЃЋрЃўрЃќрЃљрЃЋ рЃћрЃ«рЃљ.

рЃЎрЃљрЃў рЃюрЃБ рЃЎрЃўрЃЊрЃћ рЃўрЃЦ рЃерЃћрЃЏрЃћрЃерЃљрЃџрЃљ рЃарЃЮ рЃћрЃА рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў рЃарЃЮ рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћ рЃЏрЃЌрЃџрЃўрЃљрЃю рЃЊрЃљрЃбрЃљрЃќрЃћ рЃЋрЃЕрЃљрЃџрЃўрЃЕрЃЮрЃЉрЃЊрЃў рЃЏрЃљрЃњрЃљрЃА рЃЊрЃљ рЃљрЃарЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃА 80% рЃќрЃћ. рЃюрЃБ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃљрЃЏрЃўрЃА рЃгрЃљрЃерЃџрЃљрЃА рЃЊрЃљ рЃљрЃ«рЃџрЃўрЃЊрЃљрЃю рЃЊрЃљрЃгрЃДрЃћрЃЉрЃљрЃА рЃ»рЃЮрЃЉрЃўрЃљ рЃљрЃ«рЃљрЃџрЃў рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃЮ.
рЃЏрЃљрЃарЃљ рЃЏрЃљрЃўрЃюрЃф рЃЎрЃљрЃўрЃљ рЃўрЃЏрЃўрЃбрЃЮрЃарЃЮ рЃћрЃ«рЃљ рЃЋрЃўрЃфрЃў
рЃарЃЮрЃЏ рЃЌрЃБ рЃЏрЃЌрЃџрЃўрЃљрЃюрЃљрЃЊ рЃњрЃљрЃЋрЃгрЃЏрЃћрЃюрЃЊрЃЊрЃў рЃФрЃљрЃљрЃљрЃљрЃљрЃю рЃЏрЃљрЃњрЃљрЃарЃў рЃерЃћрЃЊрЃћрЃњрЃў рЃЏрЃћрЃЦрЃюрЃћрЃЉрЃЮрЃЊрЃљ.

рЃЎрЃљрЃў рЃЊрЃљрЃЋрЃўрЃгрЃДрЃћрЃЉ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃЮрЃдрЃЮрЃюрЃЊ рЃўрЃАрЃћ рЃарЃЮ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃюрЃЋрЃћ рЃЏрЃћрЃЦрЃюрЃћрЃЉрЃљ рЃњрЃљрЃАрЃърЃџрЃўрЃбрЃБрЃџрЃў. рЃЊрЃљ рЃўрЃЦ рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ prophet-рЃА.


# experiment_4_k.ipynb

рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃЏрЃћрЃАрЃљрЃЏрЃћрЃерЃў рЃЊрЃљрЃерЃЋрЃћрЃЉрЃБрЃџрЃў рЃерЃћрЃфрЃЊрЃЮрЃЏрЃљ рЃњрЃљрЃЏрЃЮрЃЋрЃљрЃАрЃгрЃЮрЃарЃЮрЃЌ.
рЃўрЃЊрЃћрЃљрЃерЃў рЃўрЃњрЃўрЃЋрЃћрЃА рЃЋрЃўрЃќрЃљрЃЋ рЃарЃљрЃАрЃљрЃф рЃЏрЃћрЃАрЃљрЃљрЃЏрЃћрЃерЃў рЃЏрЃљрЃарЃљ рЃерЃћрЃфрЃЊрЃЮрЃЏрЃћрЃЉрЃА рЃЋрЃћрЃфрЃЊрЃћрЃЉрЃў рЃљрЃЋрЃљрЃарЃўрЃЊрЃЮ рЃЌрЃљрЃЋрЃў.

рЃюрЃБ рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋрЃљрЃЊ рЃўрЃњрЃўрЃЋрЃћрЃА рЃЋрЃљрЃЎрЃћрЃЌрЃћрЃЉ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЊрЃљрЃАрЃљрЃгрЃДрЃўрЃАрЃерЃўрЃЋрЃћ рЃЋрЃДрЃЮрЃц рЃЊрЃљрЃбрЃљрЃА.
рЃљрЃАрЃћрЃЋрЃћ one hot encoding for type.

рЃљрЃЏрЃўрЃА рЃЏрЃћрЃарЃћ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњ рЃЊрЃљрЃбрЃљрЃќрЃћ рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃћ рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃљрЃЏрЃЮрЃдрЃћрЃЉрЃљ.

Training Outlier Detection Results:
   Total outliers: 14,179 (4.22%)
   Holiday outliers: 807
   Non-holiday outliers: 13,372

­Ъџѓ Training: 321,582 records (removed 14,179)
­Ъћ« Validation: 82,260 records (removed 3,549)

189 рЃАрЃЋрЃћрЃбрЃў рЃњрЃљрЃЦ рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ

Type: 3 dummy variables (Type_A, Type_B, Type_C)
Store: 45 dummy variables (Store_1, Store_2, ..., Store_45)
Dept: 81 dummy variables (Dept_1, Dept_2, ..., Dept_81)

рЃ«рЃЮрЃЮ рЃ«рЃЮрЃЊрЃљ рЃћрЃ«рЃљ рЃЊрЃљрЃЋрЃцрЃўрЃЦрЃарЃЊрЃў рЃЊрЃљ рЃўрЃЊрЃћрЃљрЃе рЃЌрЃўрЃЌрЃЮ рЃАрЃЌрЃЮрЃарЃўрЃАрЃЌрЃЋрЃўрЃА рЃфрЃљрЃџ рЃфрЃљрЃџрЃЎрЃћ рЃарЃЮрЃЏ рЃљрЃЋрЃљрЃгрЃДрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃЊрЃљ рЃЏрЃћрЃарЃћ рЃњрЃљрЃЋрЃљрЃћрЃарЃЌрЃўрЃљрЃюрЃЮ рЃћрЃњрЃћрЃф рЃџрЃЮрЃњрЃўрЃЎрЃБрЃарЃљрЃЊ рЃерЃћрЃўрЃџрЃћрЃЉрЃљ рЃЕрЃљрЃўрЃЌрЃЋрЃљрЃџрЃЮрЃА. рЃЏрЃљрЃарЃљ рЃЎрЃљрЃў рЃАрЃљрЃЕрЃљрЃџрЃўрЃЕрЃЮрЃљ рЃЊрЃљ рЃфрЃБрЃЊрЃўрЃљ рЃгрЃћрЃАрЃўрЃЌ рЃърЃарЃљрЃЦрЃбрЃўрЃЎрЃљрЃерЃў. рЃЏрЃћрЃарЃћ рЃЋрЃўрЃЎрЃўрЃЌрЃ«рЃљрЃЋ рЃЏрЃљрЃўрЃюрЃф рЃерЃћрЃюрЃЌрЃљрЃю.

Training Metrics:
   WMAE: $52.89
   MAE: $52.34
   RMSE: $77.13
   R┬▓: 1.0000
   Holiday MAE: $54.58
   Non-Holiday MAE: $52.15

­Ъћ« Validation Metrics:
   WMAE: $93.04
   MAE: $90.73
   RMSE: $196.31
   R┬▓: 0.9998
   Holiday MAE: $109.52
   Non-Holiday MAE: $90.05

­Ъј» Top 15 Feature Importance:
    1. Weekly_Sales_ewm_0.5               : 0.7531
    2. Weekly_Sales_ewm_0.3               : 0.2101
    3. Weekly_Sales_rolling_min_4         : 0.0115
    4. Weekly_Sales_trend_diff            : 0.0046
    5. Weekly_Sales_rolling_max_4         : 0.0034
    6. Weekly_Sales_rolling_std_4         : 0.0025
    7. Weekly_Sales_monthly_diff          : 0.0022
    8. IsHoliday                          : 0.0021
    9. Dept_7                             : 0.0019
   10. IsMajorHoliday                     : 0.0015
   11. Weekly_Sales_lag_1                 : 0.0007
   12. Weekly_Sales_rolling_max_8         : 0.0005
   13. Weekly_Sales_rolling_mean_4        : 0.0004
   14. IsChristmasWeek                    : 0.0004
   15. Weekly_Sales_lag_2                 : 0.0004

­ЪЊѕ Model Performance Analysis:
   Training vs Validation WMAE: $52.89 vs $93.04
   Overfitting check: -43.2% difference
   Holiday vs Non-Holiday performance:
     Holiday MAE: $109.52 (2879 records)
     Non-Holiday MAE: $90.05 (79381 records)


рЃЋрЃљрЃљрЃљ рЃЎрЃўрЃЊрЃћ 94 $ рЃўрЃЮ рЃЎрЃљрЃў рЃарЃљрЃдрЃљрЃф рЃљрЃерЃЎрЃљрЃарЃљ рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљрЃљ рЃЏрЃљрЃарЃљ рЃЋрЃћрЃа рЃЋрЃ«рЃЋрЃЊрЃћрЃЉрЃў рЃарЃљ


Weekly_Sales_ewm_0.5               : 0.7531
Weekly_Sales_ewm_0.3               : 0.2101

рЃћрЃАрЃћрЃюрЃў рЃФрЃљрЃџрЃўрЃљрЃю рЃЏрЃљрЃдрЃљрЃџрЃў рЃўрЃЏрЃцрЃЮрЃарЃЌрЃљрЃюрЃАрЃўрЃЌрЃљ рЃљрЃарЃўрЃљрЃю, рЃЊрЃљ рЃџрЃЮрЃњрЃўрЃЎрЃБрЃарЃљрЃЊ рЃљрЃЦ рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ.

рЃљрЃљрЃљ рЃЋрЃАрЃўрЃЮ рЃЋрЃўрЃърЃЮрЃЋрЃћ

# Exponential weighted features
alphas = [0.1, 0.3, 0.5]
for alpha in alphas:
    df[f'{target_col}_ewm_{alpha}'] = (
        df.groupby(['Store', 'Dept'])[target_col]
        .ewm(alpha=alpha)
        .mean()
        .reset_index(level=[0,1], drop=True)
    )

рЃћрЃА рЃЏрЃЌрЃџрЃўрЃљрЃюрЃќрЃћ рЃўрЃЌрЃЋрЃџрЃўрЃА рЃЊрЃљ рЃўрЃљрЃАрЃюрЃўрЃљ рЃћрЃАрЃљрЃљ рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ.

рЃЎрЃљрЃў рЃюрЃБ рЃљрЃдрЃљрЃа рЃЏрЃўрЃюрЃЊрЃљ рЃЏрЃћ5-рЃА рЃерЃћрЃЦрЃЏрЃюрЃљ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃљрЃ«рЃџрЃўрЃЊрЃљрЃю рЃЊрЃљрЃЋрЃарЃљрЃюрЃљрЃЋ рЃърЃарЃЮрЃАрЃбрЃљ рЃЊрЃљ рЃЊрЃљрЃЋрЃцрЃўрЃЦрЃАрЃћ рЃћрЃњ рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃљ.

рЃЎрЃљрЃў рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃљрЃЉрЃљ рЃарЃљ рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃўрЃЏрЃћрЃЊрЃўрЃљ рЃЊрЃљрЃўрЃцрЃўрЃЦрЃАрЃљ.
рЃюрЃБ рЃљрЃЏрЃЮрЃЋрЃўрЃдрЃћ рЃћрЃњ lagging рЃќрЃћрЃЊрЃЏрЃћрЃбрЃљрЃЊ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў рЃўрЃДрЃЮ рЃЊрЃљ рЃЊрЃљрЃбрЃљ рЃџрЃўрЃЦрЃўрЃ»рЃА рЃўрЃгрЃЋрЃћрЃЋрЃЊрЃљ.

рЃЎрЃљрЃў рЃљрЃюрЃБ рЃћрЃ«рЃљ рЃћрЃАрЃћ рЃњрЃљрЃЏрЃЮрЃњрЃЋрЃўрЃЋрЃўрЃЊрЃљ рЃарЃЮ рЃЊрЃљрЃњрЃЋрЃарЃЕрЃљ рЃљрЃАрЃћрЃЌрЃў рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў:

 Date Features: 30 features
     Examples: ['Weekly_Sales_lag_8', 'IsChristmasWeek', 'Weekly_Sales_lag_4']
   Holiday Features: 7 features
     Examples: ['IsChristmasWeek', 'IsLaborDayWeek', 'IsHoliday']
   Lag Features: 5 features
     Examples: ['Weekly_Sales_lag_8', 'Weekly_Sales_lag_4', 'Weekly_Sales_lag_12']
   Rolling Features: 0 features
   EWM Features: 0 features
   Diff Features: 2 features
     Examples: ['Weekly_Sales_diff_4', 'Weekly_Sales_diff_1']


­Ъџѓ Training: (335761, 166)
­Ъћ« Validation: (85809, 166)

рЃ«рЃЮ рЃћрЃ«рЃљ рЃгрЃљрЃЋрЃўрЃЊрЃљ рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃў:
рЃЏрЃљрЃўрЃюрЃф рЃљрЃарЃљрЃАрЃгрЃЮрЃарЃўрЃљ
1. Weekly_Sales_lag_1                 : 0.6252
2. Weekly_Sales_lag_4                 : 0.0314
3. Weekly_Sales_diff_1                : 0.0231

WMAE: $233.41
MAE: $245.95

рЃюрЃБ рЃљрЃџрЃЉрЃљрЃЌ рЃЎрЃўрЃЊрЃћ рЃАрЃљрЃЊрЃЏрЃћ рЃЏрЃљрЃЦ рЃџрЃўрЃЦрЃўрЃ»рЃў рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃљрЃЉрЃљ.

рЃЎрЃљрЃў рЃњрЃљрЃЋрЃљрЃАрЃгрЃЮрЃарЃћ рЃЎрЃўрЃЊрЃћ рЃЊрЃљ рЃљрЃў рЃљрЃАрЃЌрЃўрЃљ рЃерЃћрЃЊрЃћрЃњрЃў:

­Ъџѓ Training Metrics:
   WMAE: $1,338.89
   MAE: $1,267.53
   RMSE: $2,495.64
   R┬▓: 0.9868

­Ъћ« Validation Metrics:
   WMAE: $2,519.10
   MAE: $2,544.79
   RMSE: $5,669.32
   R┬▓: 0.9333

­ЪЊѕ Overfitting Analysis:
   WMAE difference: 46.9%
   Рџа№ИЈ Moderate overfitting detected

­Ъј» Top 10 Feature Importance:
    1. Weekly_Sales_lag_1       : 0.6347
    2. Weekly_Sales_lag_2       : 0.2868
    3. Weekly_Sales_lag_4       : 0.0345
    4. Month                    : 0.0072
    5. DaysFromStart            : 0.0056
    6. Dept                     : 0.0054
    7. Type_A                   : 0.0048
    8. Type_B                   : 0.0034
    9. Size                     : 0.0028

рЃюрЃБ рЃћрЃ«рЃљ рЃарЃћрЃљрЃџрЃБрЃарЃА рЃњрЃљрЃЋрЃА рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃерЃў рЃЋрЃљрЃа рЃљрЃерЃЎрЃљрЃарЃљрЃЊ 1000$ рЃЏрЃљрЃЦ рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃљ.

рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃЏрЃЮрЃЊрЃў рЃЋрЃфрЃЊрЃў facebook prophet-рЃА рЃљрЃЦрЃЋрЃћ xgboost-рЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ.

рЃЎрЃљрЃў рЃљрЃЏрЃљрЃА рЃБрЃцрЃарЃЮ рЃЏрЃћрЃбрЃў рЃЊрЃарЃЮ рЃЏрЃЮрЃБрЃюрЃЊрЃА рЃЋрЃўрЃЊрЃарЃћ xgboost-рЃА

рЃљ рЃ«рЃЮ рЃАрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃЮрЃљ рЃЊрЃљ рЃарЃърЃЮрЃњрЃЮрЃарЃф рЃљрЃюрЃА рЃљрЃЦ рЃбрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў рЃЊрЃћрЃърЃљрЃарЃбрЃљрЃЏрЃћрЃюрЃбрЃў- store рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃўрЃўрЃАрЃЌрЃЋрЃўрЃА рЃњрЃЋрЃўрЃгрЃћрЃЋрЃА рЃЊрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉрЃљ рЃљрЃюрЃБ рЃўрЃА рЃћрЃАрЃљрЃЏрЃцрЃерЃћрЃюрЃў рЃарЃЮ рЃЋрЃЌрЃЦрЃЋрЃў
рЃљрЃЊрЃарЃћ рЃарЃЮ рЃћрЃњрЃарЃћ рЃерЃћрЃўрЃџрЃћрЃЉрЃљ рЃЎрЃљрЃў рЃўрЃДрЃЮрЃА рЃарЃЮ рЃфрЃљрЃџ рЃфрЃљрЃџрЃЎрЃћ рЃњрЃљрЃюрЃЋрЃўрЃ«рЃўрЃџрЃЮрЃЮ рЃЊрЃљ рЃЏрЃћрЃарЃћ рЃерЃћрЃЋрЃљрЃћрЃарЃЌрЃЮ рЃЌрЃЦрЃЮ рЃљрЃЦ рЃћрЃњ рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃљ 
рЃњрЃЋрЃўрЃгрЃћрЃЋрЃА рЃўрЃАрЃћрЃЊрЃљрЃф. рЃљрЃЏрЃўрЃбрЃЮ рЃЏрЃўрЃюрЃўрЃЏрЃБрЃЏ рЃћрЃњ рЃџрЃЮрЃњрЃўрЃЎрЃљ рЃЏрЃљрЃўрЃюрЃф рЃљрЃдрЃЏрЃЮрЃЋрЃљрЃЕрЃўрЃћ рЃарЃЮрЃЏ рЃАрЃгрЃЮрЃарЃўрЃљ.

рЃюрЃБ рЃарЃљрЃдрЃљрЃфрЃљ рЃърЃарЃЮрЃЉрЃћрЃџрЃЏрЃљ рЃЦрЃЮрЃюрЃЊрЃљ 20 рЃгрЃБрЃЌрЃќрЃћ рЃЊрЃўрЃЊрЃў рЃ«рЃљрЃюрЃў рЃўрЃДрЃЮ рЃЊрЃљ рЃљрЃЏрЃўрЃбрЃЮ рЃ»рЃЮрЃЉрЃўрЃљ рЃАрЃ«рЃЋрЃљ рЃЊрЃарЃЮрЃА рЃЊрЃљрЃЋрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃЮ рЃарЃЮрЃфрЃљ рЃАрЃгрЃЮрЃарЃљрЃЊ рЃЏрЃћрЃЦрЃюрЃћрЃЉрЃљ рЃњрЃљрЃЎрЃћрЃЌрЃћрЃЉрЃБрЃџрЃў. 


# experiment_5_future_engineering.ipynb

рЃљрЃЏ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃерЃў, рЃарЃљрЃЊрЃњрЃљрЃю рЃБрЃЎрЃЋрЃћ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃћ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃћрЃЉрЃў рЃЊрЃљ рЃЋрЃюрЃљрЃ«рЃћ рЃарЃЮрЃњрЃЮрЃарЃўрЃљ рЃЊрЃљрЃбрЃљ. рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃЋрЃўрЃќрЃљрЃЋ рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃўрЃА рЃЏрЃЌрЃџрЃўрЃљрЃю рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃА.
рЃЊрЃљрЃбрЃљрЃА рЃњрЃљрЃЋрЃДрЃЮрЃц рЃЮрЃарЃљрЃЊ рЃбрЃарЃћрЃўрЃюрЃљрЃЊ рЃЊрЃљ рЃЋрЃљрЃџрЃўрЃЊрЃљрЃфрЃўрЃљрЃЊ, 80-20 рЃќрЃћ рЃарЃљрЃЊрЃњрЃљрЃю рЃбрЃћрЃАрЃбрЃАрЃћрЃбрЃќрЃћрЃф рЃћрЃњрЃарЃћ рЃбрЃарЃљрЃўрЃюрЃЌрЃљрЃю рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ 4 рЃ»рЃћрЃа рЃърЃљрЃбрЃљрЃарЃљрЃљ.
### рЃљрЃЏрЃўрЃА рЃЏрЃћрЃарЃћ рЃБрЃЎрЃЋрЃћ рЃЋрЃљрЃърЃўрЃарЃћрЃЉ рЃљрЃАрЃћрЃЌ рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃА. рЃюрЃБ рЃарЃЮрЃњрЃЮрЃарЃф experiemt 2 рЃерЃў рЃЋрЃЦрЃћрЃюрЃў рЃћрЃњрЃарЃћ рЃЋрЃўрЃќрЃљрЃЋ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃбрЃарЃћрЃўрЃюрЃАрЃћрЃбрЃќрЃћ + рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћрЃЉ рЃЏрЃћрЃЮрЃЌрЃ«рЃћрЃерЃў рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃЦрЃћрЃюрЃў рЃЏрЃљрЃњрЃћрЃћрЃЉрЃА рЃљрЃюрЃБ рЃЊрЃљрЃЋрЃЏрЃћрЃарЃ»рЃљрЃЋ рЃЏрЃљрЃњрЃарЃљрЃЏ markdown- рЃћрЃЉрЃА рЃљрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ.
рЃљрЃАрЃћрЃЋрЃћ рЃњрЃљрЃЋрЃгрЃЏрЃўрЃюрЃЊрЃљрЃЋ рЃЊрЃљрЃбрЃљрЃА.


рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃЌрЃЦрЃЋрЃў рЃ»рЃћрЃа рЃЊрЃљрЃЋрЃљрЃџрЃЮрЃљрЃЊрЃћ рЃЊрЃљрЃбрЃљ, рЃерЃћрЃЏрЃЊрЃћрЃњ рЃљрЃЏрЃЮрЃЋрЃўрЃдрЃћ 'MarkDown1', 'MarkDown2', 'MarkDown3', 'MarkDown4', 'MarkDown5',
рЃерЃћрЃЏрЃЊрЃћрЃњ рЃЊрЃљрЃЋрЃЏрЃћрЃарЃ»рЃћ Final merged dataset: (421570, 11)

рЃерЃћрЃЏрЃЊрЃћрЃњ рЃњрЃљрЃЋрЃДрЃљрЃЋрЃў рЃЊрЃљрЃбрЃљ. рЃЮрЃдрЃЮрЃюрЃЊ рЃърЃљрЃарЃљрЃАрЃЎрЃћрЃЋрЃў рЃљрЃЋрЃўрЃдрЃћ рЃЊрЃљрЃДрЃЮрЃцрЃўрЃА рЃгрЃћрЃарЃбрЃўрЃџрЃљрЃЊ рЃЊрЃљ рЃўрЃАрЃћ.
­ЪЊЁ Split date: 2012-04-13 00:00:00
­Ъџѓ Training: 335,761 records (79.6%)
­Ъћ« Validation: 85,809 records (20.4%)
­ЪЊі Training date range: 2010-02-05 00:00:00 to 2012-04-06 00:00:00
­ЪЊі Validation date range: 2012-04-13 00:00:00 to 2012-10-26 00:00:00

рЃерЃћрЃЏрЃЊрЃћрЃњ рЃБрЃЎрЃЋрЃћ рЃЋрЃќрЃарЃБрЃюрЃљрЃЋрЃЌ рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃќрЃћ рЃЮрЃдрЃЮрЃюрЃЊ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃбрЃарЃћрЃўрЃю рЃАрЃћрЃбрЃўрЃЊрЃљрЃю рЃЌрЃљрЃЋрЃўрЃАрЃЌрЃљрЃЋрЃљрЃЊ.

рЃЏрЃљрЃарЃљ рЃЏрЃњрЃЮрЃюрЃў рЃ»рЃЮрЃЉрЃЊрЃљ рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃЊрЃўрЃЊ рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃерЃў рЃЏрЃЦрЃЮрЃюрЃЮрЃЊрЃљ рЃћрЃА рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃљрЃ«рЃџрЃўрЃЊрЃљрЃю рЃЋрЃўрЃќрЃљрЃЋ рЃљрЃЏрЃљрЃА рЃЊрЃўрЃЊ рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃерЃў- WalmartFeatureEngineer.

рЃљрЃАрЃћрЃЋрЃћ рЃарЃЮрЃњрЃЮрЃарЃф рЃЋрЃЌрЃЦрЃЋрЃў рЃњрЃЋрЃћрЃЦрЃюрЃћрЃЉрЃљ: date_features, lag_features, rolling_features, store_dept_features.
рЃюрЃБ рЃфрЃљрЃџрЃЎрЃћ рЃЏрЃљрЃЦ рЃЎрЃўрЃЊрЃћ WalmartFeaturePipeline рЃАрЃљрЃЊрЃљрЃф рЃЋрЃљрЃ«рЃЊрЃћрЃю рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃўрЃА рЃЏрЃЮрЃерЃЮрЃарЃћрЃЉрЃљрЃАрЃљрЃф рЃЊрЃљ рЃерЃћрЃюрЃЊрЃћрЃњ FeatureEngineer.

рЃЏрЃљрЃЦ рЃљрЃАрЃћрЃЋрЃћ calculate_wmae рЃЊрЃљ evaluate_model_performance рЃцрЃБрЃюрЃЦрЃфрЃўрЃћрЃЉрЃў.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/4?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D
- рЃћрЃА рЃюрЃћрЃџ-рЃюрЃћрЃџрЃљ

рЃЊрЃљ рЃарЃЮрЃфрЃљ рЃЏрЃЌрЃџрЃўрЃљрЃю рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃќрЃћ рЃњрЃљрЃЊрЃљрЃЋрЃћрЃЊрЃў рЃћрЃА: 
https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/14?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ, рЃЎрЃЋрЃџрЃљрЃЋ рЃљрЃдрЃЏрЃЮрЃЕрЃюрЃЊрЃљ рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃўрЃф рЃЊрЃљ рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃБрЃюрЃЊрЃљ рЃерЃћрЃЋрЃфрЃЋрЃљрЃџрЃЮ рЃЏрЃўрЃЊрЃњрЃЮрЃюрЃљ.
­Ъџѓ TRAINING PERFORMANCE:
   WMAE: $72.59
   MAE:  $72.65
   R┬▓:   1.0000

­Ъћ« VALIDATION PERFORMANCE:
   WMAE: $134.98
   MAE:  $132.71
   R┬▓:   0.9992


рЃЋрЃўрЃцрЃўрЃЦрЃарЃћ рЃарЃЮрЃЏ рЃћрЃњрЃарЃћрЃЋрЃћ рЃњрЃљрЃЋрЃљрЃћрЃарЃЌрЃўрЃљрЃЉрЃюрЃћрЃЉ рЃЌрЃЦрЃЮрЃЏрЃћрЃЮрЃарЃћ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃА рЃЊрЃљ рЃЏрЃћрЃЮрЃЌрЃ«рЃћрЃА рЃЌрЃЦрЃЮ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃўрЃЊрЃў рЃЊрЃарЃЮ рЃЊрЃљрЃЋрЃ«рЃљрЃарЃ»рЃћ рЃбрЃДрЃБрЃўрЃџрЃљрЃЊ рЃљрЃЋрЃљрЃњрЃћ рЃарЃљрЃдрЃљрЃф рЃБрЃќрЃљрЃарЃЏрЃљрЃќрЃљрЃарЃў рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃў рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮрЃЊ рЃўрЃАрЃћ рЃЏрЃЮрЃ«рЃЊрЃљ рЃарЃЮрЃЏ рЃАрЃгрЃЮрЃарЃљрЃЊ рЃЋрЃћрЃа рЃЏрЃБрЃерЃљрЃЮрЃЉрЃА. рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЋрЃфрЃЋрЃџрЃў рЃЏрЃўрЃЊрЃњрЃЮрЃЏрЃљрЃА рЃЊрЃљ step-bystep рЃЋрЃўрЃќрЃљрЃЋ.

рЃюрЃБ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў рЃДрЃЮрЃЋрЃћрЃџрЃў рЃерЃћрЃЏрЃЌрЃ«рЃЋрЃћрЃЋрЃўрЃАрЃЌрЃЋрЃўрЃА рЃЏрЃљрЃўрЃюрЃф рЃЊрЃљрЃЋрЃљрЃАрЃћрЃўрЃЋрЃћ.

# experiment_6_future_engineering.ipynb

рЃљрЃЦ рЃЋрЃљрЃърЃўрЃарЃћрЃЉ рЃарЃЮрЃЏ рЃЏрЃћрЃЮрЃарЃћ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў рЃЊрЃљ рЃЏрЃћрЃЮрЃЌрЃ«рЃћрЃерЃў рЃюрЃљрЃАрЃгрЃљрЃЋрЃџрЃў рЃарЃљрЃдрЃљрЃфрЃћрЃћрЃЉрЃў рЃерЃћрЃЋрЃљрЃћрЃарЃЌрЃЮ рЃЊрЃљ рЃЏрЃўрЃЋрЃўрЃ«рЃЮ рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃўрЃА рЃЎрЃљрЃарЃњрЃў рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў.

рЃЏрЃЮрЃЊрЃў рЃ»рЃћрЃа рЃърЃўрЃарЃЊрЃљрЃърЃўрЃа рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃЮрЃЌ рЃцрЃБрЃюрЃЦрЃфрЃўрЃљ рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃЊрЃљрЃбрЃљрЃА рЃЊрЃљрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃА рЃќрЃБрЃАрЃбрЃљрЃЊ рЃўрЃАрЃћ рЃарЃЮрЃњрЃЮрЃарЃф рЃЏрЃћрЃЮрЃарЃћ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃерЃў. рЃ»рЃћрЃа рЃњрЃљрЃДрЃЮрЃцрЃА 80-20рЃќрЃћ рЃЊрЃљ рЃерЃћрЃЏрЃЊрЃћрЃњ рЃЊрЃљрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃА.

Final columns: ['Store', 'Dept', 'Date', 'Weekly_Sales', 'Type', 'Size', 'Temperature', 'Fuel_Price', 'CPI', 'Unemployment', 'IsHoliday', 'Month', 'DayOfWeek', 'IsWeekend', 'IsMonthStart', 'IsMonthEnd', 'WeeksFromStart']
- рЃћрЃАрЃћрЃюрЃўрЃљ рЃЕрЃЋрЃћрЃюрЃў рЃЏрЃћрЃЮрЃарЃћ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃўрЃА рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃЦрЃЮрЃџрЃБрЃЏрЃћрЃЉрЃў.
train_data, val_data, split_info = experiment_2_pipeline()

рЃљрЃ«рЃџрЃљрЃюрЃЊрЃћрЃџ рЃЊрЃљрЃбрЃљрЃА рЃњрЃљрЃЋрЃБрЃЎрЃћрЃЌрЃћ рЃљрЃюрЃљрЃџрЃўрЃќрЃў рЃЊрЃљ рЃњрЃЋрЃљрЃЦ рЃљрЃАрЃћрЃЌрЃў:
рЃњрЃљрЃЏрЃЮрЃњрЃЋрЃўрЃЋрЃўрЃЋрЃўрЃЊрЃљ 16 Features.

­ЪЊі STARTING DATA ANALYSIS
==================================================
­ЪЊІ BASIC DATASET INFORMATION
Training shape: (335453, 17)
Validation shape: (85809, 17)
Split date: 2012-04-13 00:00:00

­Ъј» TARGET VARIABLE ANALYSIS (Weekly_Sales)
   Mean: $15,873.74
   Median: $7,636.72
   Std: $22,262.57
   Range: $-4,988.94 to $693,099.36
   Skewness: 3.178
   Kurtosis: 22.166

­ЪЈф STORE ANALYSIS
Store Type Statistics:
     Weekly_Sales                         Size             Store    Dept
             mean       std   count       mean       std nunique nunique
Type                                                                    
A        19950.28  25866.49  171570  182250.42  41479.05      22      81
B        12153.91  16852.17  130169  101822.50  30924.44      17      80
C         9490.49  15851.93   33714   40543.11   1198.38       6      66

­ЪЊЁ TEMPORAL ANALYSIS
Temporal Patterns:
   Best month: 12
   Worst month: 1
   Weekend boost: N/A (insufficient data)

­ЪћЌ FEATURE CORRELATION ANALYSIS
Strongest correlations with Weekly_Sales:
   Size: 0.246
   Month: 0.030
   Unemployment: 0.024
   CPI: 0.021
   IsMonthEnd: 0.011
   IsMonthStart: 0.006
   Fuel_Price: 0.004

РЮЊ MISSING VALUES ANALYSIS
Missing values summary:
Empty DataFrame
Columns: [Training, Validation, Train_%, Val_%]
Index: []

РюЁ DATA QUALITY SUMMARY
   ­ЪЊі Training samples: 335,453
   ­ЪЊі Validation samples: 85,809
   ­ЪћЌ Features: 16 (excluding target)
   РЮЊ Missing values: 0 in training, 0 in validation
   ­Ъј» Target range: $-4,988.94 to $693,099.36
   ­ЪЈф Store types: 3 (A, B, C)
   ­ЪЊЁ Time span: 791 days

­ЪЊі DATA ANALYSIS COMPLETED!
­ЪћЌ All plots and metrics logged to MLflow
==================================================

type-рЃАрЃЌрЃЋрЃўрЃА one hot encoderi рЃњрЃљрЃЏрЃЮрЃЏрЃарЃЕрЃљ рЃЊрЃљ рЃЕрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћ. рЃљрЃюрЃБ рЃњрЃЋрЃљрЃЦ 19 col.

рЃљрЃў рЃљрЃЦ рЃљрЃарЃў рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў.
https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/15?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃљрЃ«рЃџрЃљ рЃЎрЃўрЃЊрЃћрЃЋ рЃарЃЮрЃњрЃЮрЃарЃф рЃЏрЃћрЃЮрЃЌрЃ«рЃћ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃерЃў рЃЊрЃљрЃЋрЃљрЃЏрЃљрЃбрЃћрЃЉ рЃџрЃљрЃњрЃўрЃюрЃњ рЃЊрЃљ рЃ░рЃЮрЃџрЃўрЃЊрЃћрЃў рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃА. рЃљрЃа рЃЋрЃљрЃЏрЃљрЃбрЃћрЃЉ рЃарЃЮрЃџрЃўрЃюрЃњ рЃЊрЃљ ewm рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃћрЃњрЃћрЃюрЃў рЃарЃљрЃдрЃљрЃф рЃфрЃБрЃЊрЃљрЃЊ рЃЏрЃЮрЃЦрЃЏрЃћрЃЊрЃћрЃЉрЃћрЃю рЃЊрЃљ рЃЏрЃўрЃарЃЕрЃћрЃЋрЃюрЃўрЃљ рЃАрЃљрЃюрЃљрЃЏ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃљрЃЊ рЃњрЃљрЃЋрЃћрЃарЃЎрЃЋрЃћрЃЋрЃў рЃћрЃАрЃћрЃюрЃў рЃЏрЃЦрЃЮрЃюрЃЊрЃћрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ.

'IsSuperBowlWeek', 'IsLaborDayWeek', 'IsMajorHoliday', 'Weekly_Sales_lag_2', 'Weekly_Sales_lag_8', 'Weekly_Sales_lag_4', 'IsChristmasWeek', 'IsBackToSchool', 'Weekly_Sales_lag_3', 'IsHolidayMonth', 'IsThanksgivingWeek', 'Weekly_Sales_lag_1', 'Weekly_Sales_lag_12'

рЃЎрЃљрЃў рЃЎрЃў рЃљрЃ«рЃџрЃљ рЃљрЃЋрЃљрЃгрЃДрЃЮрЃЌ рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃў рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃўрЃА.
рЃЋрЃљрЃљрЃљ рЃџрЃљрЃњрЃўрЃюрЃњ feature-рЃћрЃЉрЃА рЃЏрЃљрЃўрЃюрЃф рЃўрЃАрЃћ weekly_sale-рЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃЌ рЃљрЃгрЃДрЃЮрЃЉрЃЊрЃљ. рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃћрЃњ рЃўрЃДрЃЮ рЃЏрЃЌрЃљрЃЋрЃљрЃарЃў рЃЏрЃўрЃюрЃБрЃАрЃў.
рЃњрЃљрЃЋрЃљрЃАрЃгрЃЮрЃарЃћ lag рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃўрЃАрЃЌрЃЋрЃўрЃА рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ training data-рЃА рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ. рЃљрЃЏрЃўрЃЌрЃў рЃЏрЃљрЃАрЃЎрЃўрЃюрЃњрЃА рЃЋрЃљрЃЎрЃћрЃЌрЃћрЃЉ рЃЊрЃљ рЃўрЃАрЃћ рЃЋрЃљрЃЎрЃћрЃЌрЃћрЃЉ.
['IsSuperBowlWeek',
  'Temperature',
  'IsLaborDayWeek',
  'WeeksFromStart',
  'Dept',
  'IsMajorHoliday',
  'Weekly_Sales_lag_2',
  'Weekly_Sales_lag_8',
  'Type_B',
  'Weekly_Sales_lag_4',
  'IsChristmasWeek',
  'Type_A',
  'IsMonthEnd',
  'IsWeekend',
  'Type_C',
  'IsBackToSchool',
  'Month',
  'Weekly_Sales_lag_3',
  'Store',
  'IsHolidayMonth',
  'IsThanksgivingWeek',
  'Unemployment',
  'IsHoliday',
  'Fuel_Price',
  'CPI',
  'Size',
  'Weekly_Sales_lag_1',
  'DayOfWeek',
  'Weekly_Sales_lag_12',
  'IsMonthStart']

рЃћрЃ«рЃљ рЃЏрЃЮрЃЊрЃў рЃБрЃЎрЃЋрЃћ рЃерЃћрЃЦрЃЏрЃюрЃўрЃџрЃў рЃцрЃљрЃўрЃцрЃџрЃљрЃўрЃюрЃў рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮрЃЌ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃерЃћрЃЋрЃЦрЃЏрЃюрЃљрЃЌ рЃЏрЃћ-7 рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў.

# experiment_7_xgboost.ipynb

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃЋрЃћрЃЕрЃљрЃџрЃўрЃЕрЃћ рЃЏрЃљрЃњрЃарЃљрЃЏ INTERNAL_ERROR: Response: {'error': 'unsupported endpoint, please contact support@dagshub.com'}
рЃЊрЃљ рЃљрЃЏрЃўрЃА рЃњрЃљрЃЏрЃЮ рЃЋрЃћрЃа рЃЕрЃљрЃЏрЃЮрЃЋрЃбрЃЋрЃўрЃарЃЌрЃћ рЃЕрЃЋрЃћрЃюрЃў рЃљрЃарЃбрЃўрЃцрЃљрЃЦрЃбрЃў рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЏрЃЮрЃЏрЃўрЃгрЃћрЃЋрЃА рЃЏрЃћ-7 рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃе рЃБрЃЉрЃарЃљрЃЮрЃњ рЃњрЃљрЃЊрЃљрЃЋрЃљрЃЎрЃЮрЃърЃЮ рЃЎрЃЮрЃЊрЃў.


https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/25?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃљрЃЦ рЃљрЃдрЃЏрЃЮрЃЋрЃљрЃЕрЃўрЃюрЃћ рЃарЃЮрЃЏ рЃбрЃћрЃАрЃб рЃАрЃћрЃбрЃерЃў рЃљрЃЏрЃљрЃбрЃћрЃЉрЃЊрЃљ type рЃЦрЃЮрЃџрЃБрЃЏрЃА рЃАрЃљрЃЊрЃљрЃф nan-рЃћрЃЉрЃў рЃћрЃгрЃћрЃарЃљ рЃљрЃЏрЃўрЃбрЃЮ рЃћрЃњ  рЃЊрЃљрЃЋрЃцрЃўрЃЦрЃАрЃћ.
рЃљрЃЏрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃњрЃљрЃЋрЃБрЃерЃЋрЃў рЃЊрЃљрЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃћрЃЉрЃБрЃџ рЃЊрЃљрЃбрЃљрЃќрЃћ xgboost.

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃарЃљрЃдрЃљрЃф рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃћрЃЉрЃў рЃљрЃЦрЃЋрЃА рЃљрЃЏ рЃЎрЃџрЃљрЃАрЃА, рЃ«рЃЮрЃЊрЃљ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃюрЃћрЃџ рЃюрЃџрЃћ рЃЋрЃфрЃЊрЃўрЃџрЃЮрЃЉ рЃњрЃљрЃЋрЃљрЃАрЃгрЃЮрЃарЃЮ
рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃДрЃЋрЃџрЃћрЃљ рЃ»рЃћрЃарЃќрЃћ рЃљрЃ«рЃљрЃџрЃў рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃў рЃарЃЮ рЃљрЃа рЃЋрЃљрЃЎрЃћрЃЌрЃЮ рЃЋрЃерЃџрЃў рЃЊрЃљ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃюрЃћрЃџ рЃюрЃћрЃџрЃљ рЃЋрЃљрЃАрЃгрЃЮрЃарЃћрЃЉ
1. ­ЪЊі TRAINING METRICS:
   WMAE: 1503.79
   RMSE: 1493.15
   MAE: 872.81
   R┬▓: 0.9796

­ЪЊі VALIDATION METRICS:
   WMAE: 16774.31 РГљ
   RMSE: 11650.46
   MAE: 4457.34
   R┬▓: 0.7182

2. ­ЪЊі TRAINING METRICS:
   WMAE: 1223.01
   RMSE: 2129.43
   MAE: 1128.36
   R┬▓: 0.9585

­ЪЊі VALIDATION METRICS:
   WMAE: 4593.32 РГљ
   RMSE: 12112.20
   MAE: 4505.92
   R┬▓: 0.6954

рЃюрЃћрЃџ-рЃюрЃћрЃџрЃљ рЃЋрЃљрЃАрЃгрЃЮрЃарЃћрЃЉ рЃЌрЃљрЃю рЃЎрЃЮрЃЊрЃА рЃЊрЃљ рЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃЊрЃћрЃЉрЃљ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЏрЃљрЃўрЃюрЃф рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃерЃў рЃЋрЃљрЃарЃЌ.
­ЪћЮ TOP 10 MOST IMPORTANT FEATURES:
   25. Weekly_Sales_lag_1        0.3655
   26. Weekly_Sales_lag_2        0.2280
   27. Weekly_Sales_lag_3        0.1263
   29. Weekly_Sales_lag_8        0.0997
   28. Weekly_Sales_lag_4        0.0551
   22. Type_A                    0.0308
   23. Type_B                    0.0262
   18. IsChristmasWeek           0.0139
   30. Weekly_Sales_lag_12       0.0068
    9. Month                     0.0063

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃћрЃА Weekly_Sales_lag рЃљрЃЏрЃљрЃЌ рЃљрЃЦрЃЋрЃЌ рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЊрЃўрЃЊрЃў рЃўрЃЏрЃцрЃЮрЃарЃЌрЃљрЃюрЃАрЃў рЃљрЃа рЃЋрЃўрЃфрЃў рЃЎрЃўрЃЊрЃћ рЃЋрЃфрЃЊрЃў рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃћрЃЉрЃљрЃА рЃЊрЃљ рЃюрЃБ рЃЌрЃБ рЃњрЃљрЃЏрЃЮрЃЋрЃљ рЃЎрЃљрЃўрЃљ рЃЌрЃБ рЃљрЃарЃљрЃЊрЃљ рЃљрЃЏ рЃџрЃљрЃњрЃћрЃЉрЃА рЃЊрЃљрЃЋрЃљрЃюрЃћрЃЉрЃћрЃЉ рЃЌрЃљрЃЋрЃА рЃЊрЃљ рЃЏрЃљрЃњрЃўрЃА рЃњрЃљрЃарЃћрЃерЃћ рЃЋрЃўрЃЕрЃљрЃџрЃЕрЃћрЃЉ рЃ»рЃЮрЃЉрЃўрЃљ. рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃЏрЃЌрЃћрЃџрЃў рЃЊрЃдрЃћ рЃгрЃљрЃўрЃдрЃЮ рЃЏрЃљрЃњрЃљрЃЌрЃќрЃћ рЃгрЃЋрЃљрЃџрЃћрЃЉрЃљрЃЏ.

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃЋрЃћрЃгрЃЋрЃљрЃџрЃћ рЃЊрЃљ рЃћрЃА lag рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў рЃљрЃарЃўрЃА рЃФрЃљрЃџрЃўрЃљрЃю рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў рЃЊрЃљ рЃЏрЃљрЃЌрЃў рЃўрЃЏрЃърЃџрЃћрЃЏрЃћрЃюрЃбрЃљрЃфрЃўрЃљрЃЏ рЃўрЃАрЃћрЃЌрЃў рЃърЃарЃЮрЃЉрЃџрЃћрЃЏрЃћрЃЉрЃў рЃњрЃљрЃЏрЃЮрЃўрЃгрЃЋрЃўрЃљ рЃарЃЮ рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃўрЃЊрЃў рЃЊрЃарЃЮ рЃгрЃљрЃўрЃдрЃЮ. рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЏрЃЮрЃЊрЃўрЃЏрЃљрЃњрЃљрЃЌ рЃњрЃљрЃарЃћрЃерЃћ рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃЮрЃЌ. рЃљрЃюрЃБ рЃљрЃа рЃњрЃЋрЃўрЃюрЃЊрЃљ рЃћрЃА рЃџрЃљрЃњрЃњрЃўрЃюрЃњ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў.

'n_estimators': 300,    
        'max_depth': 4,           
        'learning_rate': 0.05,   
        'subsample': 0.7,         
        'colsample_bytree': 0.7,  
        'min_child_weight': 3,    
        'gamma': 0.1,             
        'reg_alpha': 0.1,      
        'reg_lambda': 1.0,     
        'random_state': 42,

­ЪЊі TRAINING METRICS:
   WMAE: 3306.82
   RMSE: 4794.32
   MAE: 3256.20
   R┬▓: 0.7899

­ЪЊі VALIDATION METRICS:
   WMAE: 7479.42 РГљ
   RMSE: 15933.22
   MAE: 7427.52
   R┬▓: 0.4729

рЃарЃЮ рЃЏрЃЮрЃЋрЃљрЃерЃЮрЃарЃћ рЃџрЃљрЃњрЃўрЃюрЃњ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃњрЃљрЃБрЃЏрЃ»рЃЮрЃЉрЃћрЃАрЃЊрЃљ рЃерЃћрЃЊрЃћрЃњрЃў рЃюрЃБ рЃАрЃљрЃерЃўрЃюрЃћрЃџрЃў рЃерЃћрЃЊрЃћрЃњрЃўрЃљ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃўрЃЏрЃљрЃА рЃ»рЃЮрЃЉрЃўрЃљ.

Training XGBoost model...
   ­ЪЊІ Parameters: {'n_estimators': 100, 'max_depth': 3, 'learning_rate': 0.03, 'subsample': 0.6, 'colsample_bytree': 0.6, 'min_child_weight': 5, 'gamma': 0.2, 'reg_alpha': 0.2, 'reg_lambda': 2.0, 

­ЪЊі TRAINING METRICS:
   WMAE: 7470.71
   RMSE: 9719.44
   MAE: 7428.61
   R┬▓: 0.1365

­ЪЊі VALIDATION METRICS:
   WMAE: 13045.05 РГљ
   RMSE: 22284.83
   MAE: 12972.71
   R┬▓: -0.0310

   рЃњрЃљрЃЋрЃљрЃБрЃљрЃарЃћрЃАрЃћ:(

Parameters: {'n_estimators': 200, 'max_depth': 8, 'learning_rate': 0.05, 'subsample': 0.8, 'colsample_bytree': 0.8, 'colsample_bylevel': 0.8, 'min_child_weight': 3, 'gamma': 0.1, 'reg_alpha': 0.1, 'reg_lambda': 1.0,

­ЪЊі TRAINING METRICS:
   WMAE: 1824.73
   RMSE: 2826.92
   MAE: 1799.88
   R┬▓: 0.9269

­ЪЊі VALIDATION METRICS:
   WMAE: 5898.46 РГљ
   RMSE: 14480.74
   MAE: 5845.00
   R┬▓: 0.5647

рЃћрЃАрЃћ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃўрЃљ рЃЏрЃљрЃарЃљ рЃЎрЃЋрЃџрЃљрЃЋ рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃерЃў рЃЋрЃљрЃа.

рЃЎрЃљрЃў рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃЏрЃћрЃЮрЃарЃћ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃА рЃЋрЃБрЃДрЃБрЃарЃћрЃЉ рЃЊрЃљ рЃЏрЃљрЃюрЃЊ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃерЃћрЃЊрЃћрЃњрЃў рЃњрЃЋрЃљрЃЦ рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃ«рЃЮрЃЊрЃљ рЃЏрЃљрЃюрЃЊ рЃљрЃАрЃћрЃЋрЃћ рЃАрЃ«рЃЋрЃљ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў рЃЏрЃљрЃЦ рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЏрЃљрЃЦ рЃљрЃАрЃћрЃЌрЃў рЃўрЃЊрЃћрЃљ рЃарЃЮ рЃЏрЃљрЃюрЃЊ рЃарЃљ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃўрЃф рЃЏрЃљрЃЦ рЃњрЃљрЃюрЃАрЃ«рЃЋрЃљрЃЋрЃћрЃЉрЃБрЃџрЃћрЃЉрЃў рЃћрЃњрЃћрЃюрЃў рЃЕрЃљрЃЋрЃљрЃЏрЃљрЃбрЃЮ рЃЊрЃљ рЃўрЃАрЃћ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮ.
https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/33

­ЪЊі TRAINING METRICS:
   WMAE: 1822.30
   RMSE: 2806.07
   MAE: 1790.54
   R┬▓: 0.9280

­ЪЊі VALIDATION METRICS:
   WMAE: 5971.66 РГљ
   RMSE: 14599.85
   MAE: 5918.78
   R┬▓: 0.5575


['Store', 'Dept', 'Size', 'Temperature', 'Fuel_Price', 'CPI', 'Unemployment', 'IsHoliday', 'Month', 'DayOfWeek', 'IsWeekend', 'IsMonthStart', 'IsMonthEnd', 'WeeksFromStart', 'IsSuperBowlWeek', 'IsLaborDayWeek', 'IsThanksgivingWeek', 'IsChristmasWeek', 'IsMajorHoliday', 'IsHolidayMonth', 'IsBackToSchool', 'Type_Encoded', 'Type_A', 'Type_B', 'Type_C']

рЃљрЃў рЃћрЃА рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃў рЃњрЃљрЃЏрЃЮрЃЏрЃўрЃЋрЃўрЃЊрЃљ рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮ рЃ»рЃљрЃЏрЃерЃў.
рЃюрЃБ рЃљрЃЏ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃўрЃАрЃЌрЃЋрЃўрЃА рЃАрЃљрЃЎрЃЏрЃљрЃарЃўрЃАрЃўрЃљ.


# experiment_8_k.ipynb

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃЉрЃћрЃЋрЃарЃў рЃњрЃќрЃљ рЃњрЃљрЃюрЃЋрЃўрЃ«рЃўрЃџрЃћ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃарЃљрЃдрЃљрЃф рЃљрЃа рЃЏрЃљрЃЎрЃЏрЃљрЃДрЃЮрЃцрЃўрЃџрЃћрЃЉрЃА рЃЏрЃўрЃюрЃЊрЃљ рЃарЃЮрЃЏ рЃћрЃарЃЌрЃ«рЃћрЃџ рЃЎрЃўрЃЊрЃћрЃЋ рЃњрЃљрЃЋрЃўрЃљрЃќрЃарЃЮ рЃЊрЃљрЃбрЃљ рЃЊрЃљ рЃљрЃдрЃЏрЃЮрЃЋрЃљрЃЕрЃўрЃюрЃЮ рЃЎрЃљрЃюрЃЮрЃюрЃќрЃЮрЃЏрЃўрЃћрЃарЃћрЃЉрЃћрЃЉрЃў.

рЃљрЃЏ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃерЃў рЃЏрЃўрЃЋрЃДрЃЋрЃћрЃЉрЃў рЃДрЃЋрЃћрЃџрЃљрЃцрЃћрЃарЃА рЃЊрЃљ рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ markdown-рЃћрЃЉрЃАрЃљрЃЊ рЃЊрЃљ lagging рЃцрЃўрЃфрЃћрЃарЃћрЃЉрЃАрЃљрЃф. рЃ»рЃћрЃа lightgbm-рЃА рЃЊрЃљрЃЋрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉ:

 MODEL EVALUATION
==================================================
LightGBM WMAE: 2,418.70

рЃљрЃЏрЃўрЃА рЃЏрЃћрЃарЃћ xgboost

­ЪћЇ MODEL COMPARISON:
XGBoost WMAE: 2,491.51
LightGBM WMAE: 2,418.70
­ЪЈє LightGBM wins by +2.9%

рЃюрЃБ рЃЏрЃћрЃбрЃў рЃљрЃарЃљрЃцрЃћрЃарЃў рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃћ рЃБрЃЉрЃарЃљрЃџрЃЮрЃЊ рЃарЃљрЃдрЃљрЃфрЃћрЃћрЃЉрЃў рЃљрЃЦ.


# experiment_9_prophet

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃћрЃ«рЃљ рЃБрЃЎрЃЋрЃћ рЃЊрЃљрЃЋрЃўрЃгрЃДрЃћрЃЉ рЃњрЃљрЃбрЃћрЃАрЃбрЃЋрЃљрЃА рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃўрЃЌ.

рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮрЃЊ рЃљрЃЋрЃўрЃдрЃћрЃЉ рЃўрЃАрЃћрЃЋ рЃЏрЃћ-7 рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃерЃў рЃЏрЃўрЃдрЃћрЃЉрЃБрЃџрЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃА рЃЊрЃљ рЃЊрЃљрЃбрЃљрЃА рЃЊрЃљрЃЋрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉ рЃћрЃњрЃарЃћ 

['Store', 'Dept', 'Size', 'Temperature', 'Fuel_Price', 'CPI', 'Unemployment', 'IsHoliday', 'Month', 'DayOfWeek', 'IsWeekend', 'IsMonthStart', 'IsMonthEnd', 'WeeksFromStart', 'IsSuperBowlWeek', 'IsLaborDayWeek', 'IsThanksgivingWeek', 'IsChristmasWeek', 'IsMajorHoliday', 'IsHolidayMonth', 'IsBackToSchool', 'Type_Encoded', 'Type_A', 'Type_B', 'Type_C']

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/35?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃљрЃЏ рЃћрЃЦрЃАрЃърЃћрЃарЃўрЃЏрЃћрЃюрЃбрЃе рЃЋрЃЮрЃДрЃћрЃюрЃћрЃЉ prophet-рЃА. рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃарЃљ рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃерЃћрЃЊрЃћрЃњрЃў:

рЃЊрЃўрЃЊрЃў рЃЊрЃарЃЮ рЃЎрЃў рЃЏрЃўрЃљрЃЦрЃЋрЃА рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃА 25 рЃгрЃБрЃЌрЃў 

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/36

рЃЎрЃљрЃўрЃљ рЃћрЃА рЃЎрЃљрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃЊрЃљ:

­Ъј» Successful models: 3167
   РЮї Failed models: 146

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $1,871.08
   MAE: $1,819.20
   RMSE: $3,786.26
   R┬▓: 0.9702


# experiment_10_ARIMA

рЃћрЃ«рЃљ рЃБрЃЎрЃЋрЃћ рЃўрЃњрЃўрЃЋрЃћ рЃюрЃљрЃўрЃарЃў рЃцрЃўрЃЕрЃћрЃа рЃўрЃюрЃ»рЃўрЃюрЃћрЃћрЃарЃўрЃюрЃњрЃўрЃЌ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮрЃЌ рЃљрЃарЃўрЃЏрЃљрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/37?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃљрЃЏрЃљрЃА 19 рЃгрЃБрЃЌрЃў рЃЊрЃљрЃГрЃўрЃарЃЊрЃљ рЃЏрЃљрЃарЃљ рЃњрЃљрЃЋрЃўрЃЊрЃљ рЃЉрЃЮрЃџрЃЮрЃерЃў рЃарЃЮрЃњрЃЮрЃарЃф рЃўрЃЦрЃюрЃљ

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $2,589.86
   MAE: $2,546.16
   RMSE: $5,267.98
   R┬▓: 0.9424

рЃћрЃАрЃћрЃюрЃўрЃф рЃЏрЃерЃЋрЃћрЃюрЃўрЃЋрЃарЃљрЃЊ рЃњрЃљрЃЏрЃЮрЃўрЃДрЃБрЃарЃћрЃЉрЃљ рЃЎрЃљрЃарЃњрЃў рЃцрЃарЃћрЃЊрЃўрЃЦрЃерЃћрЃюрЃћрЃЉрЃўрЃљ


# Experiment_11_sarimax.ipynb

рЃЎрЃљрЃў рЃљрЃ«рЃџрЃљ рЃњрЃљрЃЋрЃљрЃЎрЃћрЃЌрЃЮрЃЌ рЃАрЃљрЃарЃўрЃЏрЃљрЃЦрЃАрЃўрЃЌ рЃарЃЮрЃЏрЃћрЃџрЃўрЃф рЃљрЃарЃўрЃЏрЃљрЃА рЃБрЃЏрЃљрЃбрЃћрЃЉрЃА рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљрЃА рЃЊрЃљ рЃгрЃћрЃАрЃўрЃЌ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃБрЃюрЃЊрЃљ рЃўрЃДрЃЮрЃА рЃЋрЃўрЃЊрЃарЃћ рЃљрЃарЃўрЃЏрЃљрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў.

рЃ«рЃЮ рЃљрЃЦ sarimax рЃњрЃЋрЃљрЃЦ рЃЊрЃљ рЃљрЃарЃљ sarima , рЃљрЃюрЃБ рЃЊрЃљрЃњрЃЋрЃћрЃЏрЃљрЃбрЃљ eXogenous variables (marketing spend, holidays, weather) рЃљрЃюрЃБ рЃБрЃцрЃарЃЮ рЃЎрЃљрЃарЃњрЃўрЃљ рЃарЃЮрЃфрЃљ 
рЃ░рЃЮрЃџрЃўрЃЊрЃћрЃў рЃљрЃю рЃљрЃў рЃўрЃАрЃћрЃЌрЃў рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃў рЃњрЃЋрЃљрЃЦ рЃАрЃљрЃЊрЃљрЃф рЃЊрЃдрЃћ рЃарЃЮрЃњрЃЮрЃарЃўрЃљ рЃЏрЃљрЃњрЃљрЃА рЃљрЃЦрЃЋрЃА рЃЏрЃюрЃўрЃерЃЋрЃюрЃћрЃџрЃЮрЃЉрЃљ. 

­ЪЊі Training shape: (292063, 25)
   ­ЪЊі Validation shape: (84314, 25)
   ­Ъј» Features: 25

рЃърЃарЃћрЃърЃарЃЮрЃфрЃћрЃАрЃўрЃюрЃњрЃўрЃА рЃерЃћрЃЏрЃЊрЃћрЃњ рЃЊрЃљрЃбрЃљ рЃљрЃАрЃћ рЃњрЃљрЃЏрЃЮрЃўрЃБрЃДрЃБрЃарЃћрЃЉрЃљ рЃ«рЃЮрЃџрЃЏрЃћ.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/43?searchFilter=&orderByKey=attributes.start_time&orderByAsc=false&startTime=ALL&lifecycleFilter=Active&modelVersionFilter=All+Runs&datasetsFilter=W10%3D

рЃарЃљрЃЏрЃЊрЃћрЃюрЃўрЃЏрЃћ рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃў рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃћ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃўрЃЊрЃў рЃЊрЃарЃЮ рЃЏрЃўрЃЦрЃЮрЃюрЃЊрЃљ рЃљрЃЏрЃўрЃбрЃЮ рЃњрЃљрЃЋрЃљрЃЏрЃљрЃарЃбрЃўрЃЋрЃћ рЃЊрЃљ рЃАрЃљрЃЉрЃЮрЃџрЃЮрЃЮрЃЊ рЃћрЃА рЃерЃћрЃЊрЃћрЃњрЃўрЃљ:
­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $3,227.31
   MAE: $3,178.40
   RMSE: $7,723.57
   R┬▓: 0.8762

рЃюрЃБ рЃљрЃарЃўрЃЏрЃљрЃќрЃћ рЃБрЃљрЃарЃћрЃАрЃўрЃљ рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃЏрЃљрЃџрЃћ рЃЊрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃЊрЃљ рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ рЃарЃЌрЃБрЃџрЃў рЃЊрЃарЃЮрЃерЃў рЃФрЃљрЃџрЃўрЃљрЃю рЃўрЃгрЃћрЃџрЃћрЃЉрЃЮрЃЊрЃљ.


# Experiment 12 timesfm

рЃЎрЃљрЃў рЃЏрЃЮрЃЊрЃў рЃЎрЃўрЃЊрЃћрЃЋ рЃћрЃарЃЌрЃў рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮрЃЌ timesfm - рЃюрЃБрЃћ рЃћрЃА рЃбрЃарЃљрЃюрЃАрЃцрЃЮрЃарЃЏрЃћрЃб based рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃљ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЏрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃћрЃЉрЃА рЃћрЃ«рЃљ.
рЃарЃЮрЃњрЃЮрЃарЃф рЃњрЃљрЃЋрЃћрЃарЃЎрЃЋрЃўрЃћ рЃњрЃБрЃњрЃџрЃўрЃА рЃњрЃљрЃЎрЃћрЃЌрЃћрЃЉрЃБрЃџрЃўрЃљ рЃЊрЃљ рЃФрЃљрЃџрЃўрЃљрЃю рЃЊрЃўрЃЊ рЃЌрЃљрЃўрЃЏ рЃАрЃћрЃарЃўрЃћрЃА рЃЊрЃљрЃбрЃљрЃќрЃћрЃљ рЃЊрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉрЃБрЃџрЃў рЃћрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў.

рЃърЃарЃћ рЃбрЃарЃћрЃўрЃюрЃЊ рЃарЃљрЃЊрЃњрЃљрЃю рЃљрЃарЃўрЃА рЃерЃћрЃўрЃФрЃџрЃћрЃЉрЃљ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃерЃћрЃЊрЃћрЃњрЃў рЃЊрЃљрЃЊрЃЮрЃА рЃЋрЃўрЃЊрЃарЃћ рЃљрЃ«рЃџрЃљрЃюрЃЊрЃћрЃџрЃў рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃћрЃЉрЃў рЃЊрЃћрЃЉрЃћрЃю.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/44

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $1,985.27
   MAE: $1,976.18
   RMSE: $4,068.65
   R┬▓: 0.9131

рЃћрЃА рЃўрЃДрЃЮ рЃЏрЃљрЃарЃбрЃўрЃЋрЃў рЃЋрЃљрЃарЃўрЃљрЃюрЃбрЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃў 

рЃБрЃцрЃарЃЮ рЃњрЃљрЃЋрЃљрЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃћ рЃЊрЃљ рЃћрЃА рЃљрЃарЃўрЃА рЃБрЃцрЃарЃЮ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃў

рЃЏрЃЮрЃЊрЃў рЃўрЃАрЃћ рЃЋрЃўрЃќрЃљрЃЋ рЃарЃЮрЃЏ рЃљрЃЏрЃљрЃЋрЃћ notebook-рЃерЃў рЃўрЃДрЃЮрЃА рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃф рЃЉрЃљрЃарЃћрЃЏ.
рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃў рЃарЃЮрЃЏ рЃњрЃљрЃЏрЃ«рЃЊрЃљрЃарЃўрЃДрЃЮ рЃЋрЃЦрЃћрЃюрЃў рЃерЃћрЃЏрЃЊрЃћрЃњрЃў рЃарЃљрЃЏ:

рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ 3 рЃЏрЃЮрЃЊрЃћрЃџрЃА , рЃџрЃЮрЃюрЃњ, рЃЕрЃЋрЃћрЃБрЃџрЃћрЃЉрЃарЃўрЃЋ рЃЊрЃљ рЃерЃЮрЃарЃЌрЃА рЃарЃЮрЃЏрЃџрЃћрЃЉрЃўрЃф рЃњрЃБрЃџрЃўрЃАрЃ«рЃЏрЃЮрЃЉрЃА рЃЌрЃБ рЃарЃљрЃЏрЃ«рЃћрЃџрЃљ рЃЎрЃЮрЃюрЃбрЃћрЃЦрЃАрЃбрЃўрЃА рЃќрЃЮрЃЏрЃљ рЃљрЃЦрЃЋрЃАрЃЌ :

# Standard model (balanced)
context_len=128, horizon_len=64

# Long context model (for complex patterns) 
context_len=256, horizon_len=32

# Short horizon model (immediate predictions)
context_len=64, horizon_len=16

рЃљрЃЏрЃљрЃАрЃЌрЃљрЃю рЃћрЃарЃЌрЃљрЃЊ рЃЋрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉ рЃљрЃЏ рЃАрЃљрЃЏрЃўрЃЋрЃћ рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃЊрЃљ рЃерЃћрЃЏрЃЊрЃћрЃњ рЃћрЃюрЃАрЃћрЃЏрЃЉрЃџ рЃърЃарЃўрЃюрЃфрЃўрЃърЃўрЃЌ рЃЋрЃљрЃ»рЃљрЃЏрЃћрЃЉ
model_weights = {
    'standard': 1.0,     
    'long_context': 0.9,  
    'short_horizon': 0.8
}
рЃљрЃЦрЃЋрЃЌ рЃЌрЃљрЃЋрЃўрЃАрЃў рЃгрЃЮрЃюрЃћрЃЉрЃўрЃф.

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/44

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $2,535.07
   MAE: $2,480.96
   RMSE: $4,173.24
   R┬▓: 0.7989


# Experiment 13 N-Beats

рЃЎрЃљрЃў рЃњрЃљрЃЊрЃљрЃЋрЃћрЃЊрЃўрЃЌ deep learning-рЃўрЃА рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃўрЃА рЃњрЃљрЃбрЃћрЃАрЃбрЃЋрЃљрЃќрЃћ. 
рЃюрЃБ рЃгрЃћрЃарЃўрЃљ рЃарЃЮ рЃЋрЃћрЃюрЃўрЃерЃўрЃюрЃњ рЃњрЃарЃљрЃЊрЃўрЃћрЃюрЃбрЃћрЃЉрЃА рЃћрЃарЃўрЃЊрЃћрЃЉрЃљ рЃЊрЃљ рЃљрЃАрЃћрЃЋрЃћ рЃЏрЃљрЃарЃбрЃўрЃЋрЃўрЃљрЃЮ рЃЊрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉрЃљрЃЮ.

рЃЋрЃюрЃљрЃ«рЃЮрЃЌ рЃљрЃЉрЃљ рЃарЃљ рЃерЃћрЃЊрЃћрЃњрЃА рЃЊрЃљрЃЊрЃћрЃЉрЃА.

­Ъџђ Training N-BEATS model...
   Epoch   0: Train Loss = 0.822043, Val Loss = 0.714339
   Epoch  20: Train Loss = 0.047840, Val Loss = 0.678586
   Epoch  40: Train Loss = 0.058264, Val Loss = 0.681264
   Epoch  60: Train Loss = 0.007083, Val Loss = 0.662860
   Epoch  80: Train Loss = 0.000364, Val Loss = 0.655802

РюЁ Evaluation complete!
   ­Ъј» WMAE: $1,399.42
   ­ЪЊі MAE: $1,369.29
   ­ЪЊі RMSE: $2,581.87
   ­ЪЊі R┬▓: 0.9240

рЃћрЃА рЃЎрЃўрЃЊрЃћ рЃўрЃДрЃЮ рЃерЃћрЃЊрЃћрЃњрЃў, рЃюрЃБ рЃЎрЃљрЃў рЃерЃћрЃЊрЃћрЃњрЃўрЃљ рЃЕрЃћрЃЏрЃў рЃљрЃќрЃарЃўрЃЌ. рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЏрЃљрЃўрЃюрЃф рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃе рЃгрЃљрЃЋрЃўрЃЊрЃљ.

https://wandb.ai/konstantine25b-free-university-of-tbilisi-/walmart-nbeats-forecasting/runs/wdkyvyvq



# Experiment 14 DLearner

рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮрЃЌ рЃАрЃ«рЃЋрЃљ рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃў DLearner

рЃарЃЮрЃњрЃЮрЃарЃф рЃЏрЃЮрЃЋрЃўрЃФрЃўрЃћ рЃћрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃЎрЃљрЃарЃњрЃўрЃљ long-horizon univariate forecasting-рЃўрЃАрЃЌрЃЋрЃўрЃА. 
рЃљрЃЦ nbeats-рЃАрЃЌрЃљрЃю рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљрЃА рЃЋрЃўрЃДрЃћрЃюрЃћрЃЉрЃЌ рЃБрЃЎрЃћрЃЌрЃћрЃАрЃљрЃЊ рЃљрЃАрЃћрЃЋрЃћ рЃгрЃћрЃарЃўрЃљ рЃарЃЮрЃЏ рЃћрЃАрЃћрЃф рЃЏрЃљрЃарЃбрЃўрЃЋрЃљрЃЊ рЃЊрЃљрЃАрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉрЃћрЃџрЃў рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃљ рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ.

https://wandb.ai/konstantine25b-free-university-of-tbilisi-/walmart-dlinear-forecasting

­ЪЊѕ Training Results:
   ­Ъј» Train WMAE: $1,100.11
   ­ЪЊі Train MAE: $1,096.35
   ­ЪЊі Train R┬▓: 0.9604

­ЪЊЅ Validation Results:
   ­Ъј» Val WMAE: $1,424.41
   ­ЪЊі Val MAE: $1,378.75
   ­ЪЊі Val R┬▓: 0.9275

рЃљрЃЏрЃљрЃюрЃљрЃф рЃАрЃљрЃЎрЃљрЃЏрЃЮрЃЊ рЃЎрЃљрЃарЃњрЃљрЃЊ рЃўрЃЏрЃБрЃерЃљрЃЋрЃљ. рЃЉрЃћрЃЋрЃарЃљрЃЊ рЃЎрЃљрЃў рЃерЃћрЃЊрЃћрЃњрЃўрЃљ рЃАрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃЮрЃљ рЃўрЃЦ рЃарЃћрЃљрЃџрЃБрЃа рЃбрЃћрЃАрЃбрЃАрЃћрЃбрЃќрЃћ рЃарЃљ рЃўрЃЦрЃюрЃћрЃЉрЃљ. рЃљрЃа рЃЋрЃљрЃарЃЌ рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃерЃў. рЃљрЃюрЃБ рЃЮрЃЊрЃюрЃљрЃЋ рЃЋрЃљрЃарЃЌ рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЎрЃљрЃўрЃљ рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃЌрЃљрЃю рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ.


# Experiment 15 PatchTST

рЃЎрЃљрЃў рЃћрЃ«рЃљ рЃњрЃљрЃЋрЃбрЃћрЃАрЃбрЃЮрЃЌ рЃАрЃ«рЃЋрЃљ рЃЏрЃЮрЃЊрЃћрЃџрЃў PatchTST

Divides the time series into non-overlapping patches (e.g., chunks of 16 or 32 timesteps)

Flattens + projects those patches into embeddings

Feeds these embeddings into a standard Transformer encoder

рЃюрЃБ рЃћрЃА рЃбрЃарЃљрЃюрЃАрЃцрЃЮрЃарЃЏрЃћрЃа рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃљ рЃарЃљрЃф рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ рЃАрЃљрЃўрЃюрЃбрЃћрЃарЃћрЃАрЃЮрЃљ рЃњрЃљрЃАрЃљрЃбрЃћрЃАрЃбрЃљрЃЊ.
рЃгрЃћрЃарЃўрЃљ рЃарЃЮрЃЏ рЃерЃћрЃЊрЃљрЃарЃћрЃЉрЃўрЃЌ рЃарЃЌрЃБрЃџрЃў рЃњрЃљрЃАрЃљрЃбрЃћрЃАрЃбрЃўрЃљрЃЮ.

https://wandb.ai/konstantine25b-free-university-of-tbilisi-/walmart-patchtst-forecasting

­ЪЊѕ Training Results:
   ­Ъј» Train WMAE: $139.22
   ­ЪЊі Train MAE: $145.96
   ­ЪЊі Train R┬▓: 0.9992

­ЪЊЅ Validation Results:
   ­Ъј» Val WMAE: $1,468.55
   ­ЪЊі Val MAE: $1,460.37
   ­ЪЊі Val R┬▓: 0.9060

рЃљрЃЦ рЃФрЃљрЃџрЃўрЃљрЃю рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃерЃў рЃЋрЃљрЃарЃЌ рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ рЃљрЃа рЃњрЃљрЃЏрЃЮрЃЊрЃњрЃљ рЃћрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃЕрЃЋрЃћрЃюрЃў рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃўрЃАрЃЌрЃЋрЃўрЃА рЃЎрЃљрЃарЃњрЃў.

# Experimetn 16 Temporal Fusion Transformer

Temporal Fusion Transformer  - google рЃЏрЃљ рЃњрЃљрЃљрЃЎрЃћрЃбрЃљ 2020-рЃерЃўрЃЮ. sequence-to-sequence рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃљрЃЮ.

рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃўрЃА рЃўрЃЏрЃцрЃЮрЃарЃЌрЃљрЃюрЃАрЃўрЃА рЃњрЃљрЃњрЃћрЃЉрЃљ рЃерЃћрЃБрЃФрЃџрЃўрЃљрЃЮ рЃЎрЃљрЃарЃњрЃљрЃЊ. рЃљрЃЏрЃљрЃЌрЃў рЃ»рЃљрЃЏрЃўрЃљ LSTM + Attention + Feature Select. 

рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ рЃерЃћрЃАрЃљрЃФрЃџрЃћрЃЉрЃћрЃџрЃўрЃљ рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ рЃЎрЃљрЃарЃњрЃў рЃўрЃДрЃЮрЃА рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЕрЃћрЃЏрЃў рЃљрЃќрЃарЃўрЃЌ timesfm-рЃА рЃЋрЃћрЃа рЃљрЃ»рЃЮрЃЉрЃћрЃЉрЃА. 

https://wandb.ai/konstantine25b-free-university-of-tbilisi-/walmart-tft-forecasting

­ЪЊѕ Training Results:
   ­Ъј» Train WMAE: $1,483.92
   ­ЪЊі Train MAE: $1,433.58
   ­ЪЊі Train R┬▓: 0.9235

­ЪЊЅ Validation Results:
   ­Ъј» Val WMAE: $1,536.30
   ­ЪЊі Val MAE: $1,487.36
   ­ЪЊі Val R┬▓: 0.9000

рЃ«рЃЮрЃЮ рЃљрЃЦ рЃЮрЃЋрЃћрЃарЃцрЃўрЃбрЃерЃў рЃюрЃљрЃЏрЃЊрЃЋрЃўрЃџрЃљ рЃљрЃа рЃљрЃарЃўрЃА рЃЊрЃљ рЃАрЃљрЃЎрЃЏрЃљрЃЮрЃЊ рЃЏрЃЮрЃЏрЃћрЃгрЃЮрЃюрЃљ рЃћрЃА рЃерЃћрЃЊрЃћрЃњрЃў.

# arima рЃЏрЃЮрЃЊрЃћрЃџрЃў

рЃЏрЃЮрЃЎрЃџрЃћрЃЊ рЃљрЃдрЃЏрЃЮрЃЋрЃљрЃЕрЃўрЃюрЃћрЃЌ рЃарЃЮрЃЏ future enginering рЃЎрЃљрЃў рЃњрЃЋрЃЦрЃЮрЃюрЃЊрЃљ. рЃЏрЃљрЃњрЃарЃљрЃЏ рЃљрЃдрЃЏрЃЮрЃЋрЃљрЃЕрЃўрЃюрЃћрЃЌ рЃарЃЮрЃЏ рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџ рЃЏрЃЮрЃЊрЃћрЃџрЃА рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљрЃюрЃљрЃўрЃарЃў
рЃбрЃарЃћрЃюрЃўрЃюрЃњрЃў рЃЊрЃљ рЃЊрЃљрЃбрЃљрЃАрЃћрЃбрЃўрЃА рЃЊрЃљрЃЏрЃБрЃерЃљрЃЋрЃћрЃЉрЃљ рЃБрЃюрЃЊрЃљ.

рЃљрЃЏрЃўрЃбрЃЮрЃЏ рЃЕрЃљрЃЋрЃБрЃ»рЃћрЃЦрЃў рЃћрЃ«рЃљ рЃАрЃљрЃЌрЃўрЃЌрЃљрЃЮрЃЊ рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃА рЃ»рЃћрЃа рЃЋрЃўрЃгрЃДрЃћрЃЉ arima-рЃЌрЃў.
рЃЋрЃБрЃДрЃБрЃарЃћ arima-рЃќрЃћ рЃЋрЃўрЃЊрЃћрЃЮрЃА рЃЊрЃљ рЃюрЃБ рЃДрЃЋрЃћрЃџрЃљрЃќрЃћ рЃЏрЃљрЃарЃбрЃўрЃЋрЃў time series рЃљрЃџрЃњрЃЮрЃарЃўрЃЌрЃЏрЃўрЃљ рЃљрЃџрЃЉрЃљрЃЌ.

AutoRegressive Integrated Moving Average
AR (AutoRegressive) РђЊ "memory of the past" todayРђЎs value depends on yesterdayРђЎs value.
I (Integrated) РђЊ "trend remover" If your data has a trend, we subtract the previous value to get the difference.
MA (Moving Average) РђЊ "shock smoother" Captures shocks/noise that impact future values.

рЃЎрЃљрЃў рЃюрЃБ рЃћрЃ«рЃљ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљрЃА рЃљрЃа рЃњрЃљрЃЏрЃЮрЃЋрЃўрЃДрЃћрЃюрЃћрЃЉ, рЃЊрЃљ рЃЌрЃљрЃЋрЃўрЃЊрЃљрЃю рЃЉрЃЮрЃџрЃЮрЃЏрЃЊрЃћ рЃАрЃбрЃљрЃбрЃўрЃАрЃбрЃўрЃЎрЃБрЃарЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃўрЃЏрЃўрЃбрЃЮрЃЏ рЃарЃЮрЃЏ рЃљрЃарЃўрЃЏрЃљрЃљ. 
рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ date рЃљрЃЦрЃЋрЃА рЃўрЃюрЃцрЃБрЃЌрЃљрЃЊ рЃљрЃЏрЃўрЃбрЃЮрЃЏ feature engineering-рЃА рЃЊрЃўрЃЊрЃў рЃљрЃќрЃарЃў рЃљрЃарЃф рЃљрЃЦрЃЋрЃА.

рЃћрЃарЃЌрЃљрЃЊрЃћрЃарЃЌрЃў рЃљрЃЦ рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃћрЃЉрЃА рЃљрЃЏрЃЮрЃЋрЃўрЃдрЃћрЃЉ рЃЮрЃдрЃЮрЃюрЃЊ рЃЌрЃљрЃЋрЃўрЃАрЃбрЃљрЃЋрЃљрЃЊ holiday рЃАрЃљрЃЊрЃљрЃф рЃљрЃарЃўрЃА рЃўрЃЦ рЃАрЃ«рЃЋрЃљ рЃўрЃЦрЃюрЃћрЃЉрЃљ рЃљрЃБрЃЌрЃџрЃљрЃўрЃћрЃарЃў.

рЃљрЃАрЃћрЃЋрЃћ рЃЎрЃЮрЃЊрЃў рЃўрЃАрЃћрЃљ рЃарЃЮрЃЏ рЃюрЃћрЃџ рЃюрЃџрЃћ рЃљрЃ░рЃўрЃърЃћрЃарЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃћрЃЉрЃўрЃА рЃЎрЃЮрЃЏрЃЉрЃўрЃюрЃљрЃфрЃфрЃўрЃЌ рЃАрЃљрЃБрЃЎрЃћрЃЌрЃћрЃАрЃЮ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃўрЃърЃЮрЃЋрЃўрЃА рЃљрЃарЃўрЃЏрЃљрЃАрЃў рЃЊрЃљ рЃерЃћрЃЏрЃЊрЃћрЃњ рЃњрЃљрЃљрЃЎрЃћрЃЌрЃЮрЃА рЃцрЃарЃћрЃЊрЃўрЃЦрЃерЃћрЃюрЃў рЃЊрЃљрЃбрЃљ рЃўрЃАрЃћрЃЋ 80/20

рЃЌрЃўрЃЌрЃЮрЃћрЃБрЃџрЃў store_dept рЃЎрЃЮрЃЏрЃЉрЃЮрЃќрЃћ рЃфрЃљрЃџ рЃфрЃљрЃџрЃЎрЃћ рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃњрЃЋрЃљрЃЦ.
Total possible combinations: 3,248 (45 stores ├Ќ ~72 departments average)
рЃљрЃў рЃћрЃА рЃљрЃарЃўрЃА рЃерЃћрЃЊрЃћрЃњрЃў:

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/52

­ЪЊі Training Metrics:
   Training WMAE: $1,556.27

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $2,011.67
   MAE: $1,976.46
   RMSE: $4,574.46
   R┬▓: 0.8273

# Sarima рЃўрЃњрЃўрЃЋрЃћ arima + рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљ.

Sarima рЃ»рЃЮрЃЉрЃўрЃљ arima-рЃА рЃўрЃЏрЃўрЃЌ рЃарЃЮрЃЏ рЃљрЃЦрЃЋрЃА рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃЮрЃЉрЃљрЃф рЃарЃљрЃф рЃњрЃБрЃАрЃџрЃўрЃАрЃЏрЃЮрЃЉрЃА рЃарЃЮрЃЏ рЃАрЃћрЃќрЃЮрЃюрЃБрЃарЃў рЃърЃљрЃбрЃћрЃарЃюрЃћрЃЉрЃўрЃА
рЃљрЃЏрЃЮрЃфрЃюрЃЮрЃЉрЃљ рЃерЃћрЃБрЃФрЃџрЃўрЃљ.
Sarima рЃўрЃдрЃћрЃЉрЃА 7 рЃърЃљрЃарЃљрЃЏрЃћрЃбрЃарЃА:
(p, d, q) РђЊ non-seasonal ARIMA terms:
p: autoregression (AR)
d: differencing (trend removal)
q: moving average (MA)

(P, D, Q, s) РђЊ seasonal parts:
P: seasonal autoregression
D: seasonal differencing
Q: seasonal moving average
s: length of the seasonal cycle (e.g., 12 for monthly, 7 for weekly)

рЃљрЃюрЃљрЃџрЃЮрЃњрЃўрЃБрЃарЃљрЃЊ рЃарЃЮрЃњрЃЮрЃарЃф arima рЃћрЃАрЃћрЃф рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ date columns-рЃА рЃЏрЃўрЃўрЃдрЃћрЃЉрЃА рЃЊрЃљ рЃЏрЃ«рЃЮрЃџрЃЮрЃЊ рЃЏрЃљрЃАрЃќрЃћ рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃЊрЃћрЃЉрЃљ рЃљрЃюрЃБ рЃљрЃа рЃГрЃўрЃарЃЊрЃћрЃЉрЃљ рЃАрЃ«рЃЋрЃљ рЃЦрЃЮрЃџрЃБрЃЏрЃюрЃћрЃЉрЃў.

рЃўрЃњрЃўрЃЋрЃћрЃюрЃљрЃўрЃарЃў рЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃўрЃЌ рЃарЃЮрЃњрЃЮрЃарЃф arima рЃерЃћрЃњрЃЋрЃўрЃФрЃџрЃўрЃљ рЃњрЃљрЃЋрЃБрЃерЃЋрЃљрЃЌ рЃћрЃА рЃЏрЃЮрЃЊрЃћрЃџрЃўрЃф.
SARIMA(1,1,1)x(0,1,0,52)

­ЪЊі Training Metrics:
   Training WMAE: $1,586.54

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $2,219.86
   MAE: $2,173.68
   RMSE: $5,867.32
   R┬▓: 0.6853

https://dagshub.com/konstantine25b/Walmart-Recruiting---Store-Sales-Forecasting.mlflow/#/experiments/58


# Experiment Sarimax

Sarimax= sarima + external regressors 

рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ рЃљрЃЦ рЃерЃћрЃњрЃЋрЃўрЃФрЃџрЃўрЃљ рЃАрЃ«рЃЋрЃљ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃўрЃА рЃњрЃљрЃЏрЃЮрЃДрЃћрЃюрЃћрЃЉрЃљрЃф рЃарЃљрЃф рЃЏрЃўрЃдрЃћрЃЉрЃБрЃџрЃў рЃњрЃЋрЃљрЃЦрЃЋрЃА.

рЃўрЃњрЃўрЃЋрЃћ рЃюрЃљрЃўрЃарЃљрЃЊ рЃЋрЃљрЃбрЃарЃћрЃўрЃюрЃўрЃюрЃњрЃћрЃЉ рЃарЃљрЃф sarima, рЃЏрЃљрЃњрЃарЃљрЃЏ рЃЏрЃљрЃюрЃЊ рЃарЃЮ рЃњрЃЋрЃљрЃЦ рЃАрЃ«рЃЋрЃљрЃЊрЃљрЃАрЃ«рЃЋрЃљ рЃцрЃўрЃЕрЃћрЃарЃћрЃЉрЃўрЃА рЃЏрЃљрЃњрЃћрЃћрЃЉрЃАрЃљрЃф рЃЋрЃљрЃбрЃљрЃю рЃўрЃюрЃцрЃўрЃЌрЃљрЃЊ. рЃерЃћрЃАрЃљрЃЉрЃљрЃЏрЃўрЃАрЃљрЃЊ рЃБрЃцрЃарЃЮ рЃЎрЃЮрЃЏрЃърЃџрЃћрЃЦрЃАрЃБрЃарЃў рЃЏрЃЮрЃЊрЃћрЃџрЃў рЃњрЃљрЃЏрЃЮрЃЊрЃўрЃА.

­ЪЊі Validation Metrics:
   WMAE (Competition Metric): $3,591.14
   MAE: $3,467.08
   RMSE: $6,590.84
   R┬▓: 0.7935

рЃюрЃБ рЃћрЃАрЃћрЃюрЃўрЃљ рЃАрЃбрЃљрЃбрЃўрЃАрЃбрЃўрЃЎрЃБрЃарЃў рЃЏрЃЮрЃЊрЃћрЃџрЃћрЃЉрЃў.

# Experiment N-Beats